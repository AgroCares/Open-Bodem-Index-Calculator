test_that("obic_field works", {
  expect_equal(
    obic_field(
      B_SOILTYPE_AGR = 'rivierklei',
      B_GWL_CLASS = "II",
      B_SC_WENR = 2,
      B_HELP_WENR = "MOb72",
      B_AER_CBS = 'LG01',
      B_LU_BRP = c( 1010, 1010,263,263, 263,265,265,265),
      A_SOM_LOI = 3.91,
      A_SAND_MI = 66.3,
      A_SILT_MI = 22.8,
      A_CLAY_MI = 7.8,
      A_PH_CC = 5.4,
      A_N_RT = 1528.33,
      A_CN_FR = 13.02,
      A_S_RT = 321.26,
      A_N_PMN = 63.3,
      A_P_AL = 50.2,
      A_P_CC = 2.9,
      A_P_WA = 50.5,
      A_CEC_CO = 56.9,
      A_CA_CO_PO = 66.87,
      A_MG_CO_PO = 13.97,
      A_K_CO_PO = 3.06,
      A_K_CC = 58.6,
      A_MG_CC = 77.53,
      A_MN_CC = 7586.61,
      A_ZN_CC = 726.2,
      A_CU_CC = 68.8,
      A_C_BCS = 1,
      A_CC_BCS = 1,
      A_GS_BCS = 1,
      A_P_BCS = 1,
      A_RD_BCS = 1,
      A_EW_BCS = 1,
      A_SS_BCS = 1,
      A_RT_BCS = 1,
      A_SC_BCS = 1,
      M_COMPOST = 0,
      M_GREEN = FALSE,
      M_NONBARE =FALSE,
      M_EARLYCROP = FALSE,
      M_SLEEPHOSE = FALSE,
      M_DRAIN = FALSE,
      M_DITCH = FALSE,
      M_UNDERSEED = FALSE,
      M_LIME = FALSE,
      M_MECHWEEDS = FALSE,
      M_NONINVTILL = FALSE,
      M_PESTICIDES_DST = FALSE,
      M_SOLIDMANURE = FALSE,
      M_SSPM = FALSE,
      M_STRAWRESIDUE = FALSE
    ),
    expected = data.table(
      I_BCS = 0.369,
      I_B_DI = 0.843,
      I_B_SF = 0.965,
      I_C_CEC = 0.569,
      I_C_CU = 1,
      I_C_K = 0.988,
      I_C_MG = 0.991,
      I_C_N = 0.888,
      I_C_P = 0.961,
      I_C_PH = 0.15,
      I_C_S = 0.26,
      I_C_ZN = 0.561,
      I_E_NGW = 0.988,
      I_E_NSW = 0.968,
      I_M = 0.069,
      I_M_BIODIVERSITY = 0.144,
      I_M_CLIMATE = 0.113,
      I_M_SOILFERTILITY = 0.144,
      I_M_WATERQUALITY = 0.126,
      I_P_CEC = 0.417,
      I_P_CO = 0.333,
      I_P_CR = 1,
      I_P_DS = 0.99,
      I_P_DU = 0.652,
      I_P_SE = 0.93,
      I_P_WRI = 0.835,
      I_P_WS = 0.017,
      S_B_OBI_A = 0.9,
      S_C_OBI_A = 0.54,
      S_E_OBI_A = 0.978,
      S_M_OBI_A = 0.069,
      S_P_OBI_A = 0.416,
      S_T_OBI_A = 0.578,
      ID = 1,
      RM_C_1 = "M8",
      RM_C_2 = "M1",
      RM_C_3 = "M2",
      RM_P_1 = "M6",
      RM_P_2 = "M3",
      RM_P_3 = "M1",
      RM_B_1 = "M0",
      RM_B_2 = "M0",
      RM_B_3 = "M0",
      key = "ID"
    ),
    tolerance = 0.01
  )
})
