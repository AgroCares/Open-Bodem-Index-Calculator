test_that('obic_field can run with a simple example',{
  expect_no_condition(
    obic_field(B_SOILTYPE_AGR = 'rivierklei',
               B_GWL_CLASS = "II",
               B_GWL_GLG = 75,
               B_GWL_GHG = 10,
               B_GWL_ZCRIT = 50,
               B_SC_WENR = '2',
               B_HELP_WENR = "MOb72",
               B_AER_CBS = 'LG01',
               B_LU_BRP = c( 1010, 1010,263,263, 263,265,265,265),
               A_SOM_LOI = 3.91,
               A_SAND_MI = 66.3,
               A_SILT_MI = 22.8,
               A_CLAY_MI = 7.8,
               A_PH_CC = 5.4,
               A_N_RT = 1528.33,
               A_CN_FR = 13.02,
               A_S_RT = 321.26,
               A_N_PMN = 63.3,
               A_P_AL = 50.2,
               A_P_CC = 2.9,
               A_P_WA = 50.5,
               A_CEC_CO = 56.9,
               A_CA_CO_PO = 66.87,
               A_MG_CO_PO = 13.97,
               A_K_CO_PO = 3.06,
               A_K_CC = 58.6,
               A_MG_CC = 77.53,
               A_MN_CC = 7586.61,
               A_ZN_CC = 726.2,
               A_CU_CC = 68.8,
               A_C_BCS = 1,
               A_CC_BCS = 1,
               A_GS_BCS = 1,
               A_P_BCS = 1,
               A_RD_BCS = 1,
               A_EW_BCS = 1,
               A_SS_BCS = 1,
               A_RT_BCS = 1,
               A_SC_BCS = 1,
               M_COMPOST = 0,
               M_GREEN = FALSE,
               M_NONBARE =FALSE,
               M_EARLYCROP = FALSE,
               M_SLEEPHOSE = FALSE,
               M_DRAIN = FALSE,
               M_DITCH = FALSE,
               M_UNDERSEED = FALSE,
               M_LIME = FALSE,
               M_MECHWEEDS = FALSE,
               M_NONINVTILL = FALSE,
               M_PESTICIDES_DST = FALSE,
               M_SOLIDMANURE = FALSE,
               M_SSPM = FALSE,
               M_STRAWRESIDUE = FALSE)
  )
})
 
test_that('B_FERT_NORM_FR can be changed in obic_field',{
  expect_false(all(
    obic_field(B_FERT_NORM_FR = 1,
               useClassicOBI = FALSE,
               B_DRAIN = FALSE,
               B_SOILTYPE_AGR = 'rivierklei',
               B_GWL_CLASS = "II",
               B_GWL_GLG = 75,
               B_GWL_GHG = 10,
               B_GWL_ZCRIT = 50,
               B_SC_WENR = '2',
               B_HELP_WENR = "MOb72",
               B_AER_CBS = 'LG01',
               B_LU_BRP = c( 1010, 1010,263,263, 263,265,265,265),
               A_SOM_LOI = 3.91,
               A_SAND_MI = 66.3,
               A_SILT_MI = 22.8,
               A_CLAY_MI = 7.8,
               A_PH_CC = 5.4,
               A_N_RT = 1528.33,
               A_CN_FR = 13.02,
               A_S_RT = 321.26,
               A_N_PMN = 63.3,
               A_P_AL = 50.2,
               A_P_CC = 2.9,
               A_P_WA = 50.5,
               A_CEC_CO = 56.9,
               A_CA_CO_PO = 66.87,
               A_MG_CO_PO = 13.97,
               A_K_CO_PO = 3.06,
               A_K_CC = 58.6,
               A_MG_CC = 77.53,
               A_MN_CC = 7586.61,
               A_ZN_CC = 726.2,
               A_CU_CC = 68.8,
               A_C_BCS = 1,
               A_CC_BCS = 1,
               A_GS_BCS = 1,
               A_P_BCS = 1,
               A_RD_BCS = 1,
               A_EW_BCS = 1,
               A_SS_BCS = 1,
               A_RT_BCS = 1,
               A_SC_BCS = 1,
               M_COMPOST = 0,
               M_GREEN = FALSE,
               M_NONBARE =FALSE,
               M_EARLYCROP = FALSE,
               M_SLEEPHOSE = FALSE,
               M_DRAIN = FALSE,
               M_DITCH = FALSE,
               M_UNDERSEED = FALSE,
               M_LIME = FALSE,
               M_MECHWEEDS = FALSE,
               M_NONINVTILL = FALSE,
               M_PESTICIDES_DST = FALSE,
               M_SOLIDMANURE = FALSE,
               M_SSPM = FALSE,
               M_STRAWRESIDUE = FALSE)
   ==
    obic_field(B_FERT_NORM = 0.5,
               useClassicOBI = FALSE,
               B_DRAIN = FALSE,
               B_SOILTYPE_AGR = 'rivierklei',
               B_GWL_CLASS = "II",
               B_GWL_GLG = 75,
               B_GWL_GHG = 10,
               B_GWL_ZCRIT = 50,
               B_SC_WENR = '2',
               B_HELP_WENR = "MOb72",
               B_AER_CBS = 'LG01',
               B_LU_BRP = c( 1010, 1010,263,263, 263,265,265,265),
               A_SOM_LOI = 3.91,
               A_SAND_MI = 66.3,
               A_SILT_MI = 22.8,
               A_CLAY_MI = 7.8,
               A_PH_CC = 5.4,
               A_N_RT = 1528.33,
               A_CN_FR = 13.02,
               A_S_RT = 321.26,
               A_N_PMN = 63.3,
               A_P_AL = 50.2,
               A_P_CC = 2.9,
               A_P_WA = 50.5,
               A_CEC_CO = 56.9,
               A_CA_CO_PO = 66.87,
               A_MG_CO_PO = 13.97,
               A_K_CO_PO = 3.06,
               A_K_CC = 58.6,
               A_MG_CC = 77.53,
               A_MN_CC = 7586.61,
               A_ZN_CC = 726.2,
               A_CU_CC = 68.8,
               A_C_BCS = 1,
               A_CC_BCS = 1,
               A_GS_BCS = 1,
               A_P_BCS = 1,
               A_RD_BCS = 1,
               A_EW_BCS = 1,
               A_SS_BCS = 1,
               A_RT_BCS = 1,
               A_SC_BCS = 1,
               M_COMPOST = 0,
               M_GREEN = FALSE,
               M_NONBARE =FALSE,
               M_EARLYCROP = FALSE,
               M_SLEEPHOSE = FALSE,
               M_DRAIN = FALSE,
               M_DITCH = FALSE,
               M_UNDERSEED = FALSE,
               M_LIME = FALSE,
               M_MECHWEEDS = FALSE,
               M_NONINVTILL = FALSE,
               M_PESTICIDES_DST = FALSE,
               M_SOLIDMANURE = FALSE,
               M_SSPM = FALSE,
               M_STRAWRESIDUE = FALSE)
  ))
})
