<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Open Soil Index • OBIC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Open Soil Index">
<meta property="og:description" content="OBIC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OBIC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/description-of-the-columns.html">Description of the columns for OBIC</a>
    </li>
    <li>
      <a href="../articles/obic_introduction.html">The Open Soil Index</a>
    </li>
    <li>
      <a href="../articles/obic_score_aggregation.html">Note on OBI score aggregation</a>
    </li>
    <li>
      <a href="../articles/obic_workability.html">Workability illustration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AgroCares/Open-Bodem-Index-Calculator/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Open Soil Index</h1>
                        <h4 data-toc-skip class="author">Gerard Ros,
Brent Riechelman</h4>
            
            <h4 data-toc-skip class="date">2023-08-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AgroCares/Open-Bodem-Index-Calculator/blob/HEAD/vignettes/obic_introduction.Rmd" class="external-link"><code>vignettes/obic_introduction.Rmd</code></a></small>
      <div class="hidden name"><code>obic_introduction.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="introduction">1. introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<div class="section level4">
<h4 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h4>
<p>To meet the demands of a growing population, agriculture continues to
intensify, along with increasing and evolving impacts on crop growth,
soil quality, and environmental quality. There has been a great increase
in world food production since the 1960s and an increase in per capita
agricultural production, accompanied by a likewise increase in machinery
and fertilizer use. Increased inputs of nitrogen and phosphorus to the
soil however, has also led to substantial negative impacts on
biodiversity, drinking and surface water quality, and human health. Both
the agronomic potential of cropping systems as well as the environmental
impacts of agriculture are highly controlled by soil properties and its
management. Soil health (or soil quality) refers to the capacity of soil
to function as a living ecosystem that sustains plants, animals, and
humans, and support ecosystem services including agricultural
production. Healthy soils are not just a growing medium for crops, they
regulate and support a set of essential ecosystem services, such as
water purification, carbon sequestration, nutrient cycling, and habitat
provision. Improving and sustaining soil health is therefore key to
sustainable crop production.</p>
<p>Many attempts have been made to develop indices to assess soil
quality as well as related ecosystem services (reviewed by Bünemann et
al., 2018; Rinot et al., 2019). To date, most of this knowledge has not
been implemented in decision support tools assisting farmers for
monitoring and evaluation of soil quality on farm and field level.
Explicit evaluation of soil quality with respect to soil threats, soil
functions, and ecosystem services has rarely been implemented. Few
approaches provide clear interpretation schemes of measured indicator
values. The main reason for this lack of valorization, is that soil is a
complex interplay of chemical, biological, and physical processes and
that the objectives for which the soil is used, have an enormous
influence on the evaluation of soil quality. However, there is broad
consensus that soil chemistry, soil structure, and soil biology, need to
be considered for a good interpretation of soil quality.</p>
<p>In order to improve and maintain soil quality while supporting
sustainable agronomic production as well as other soil ecosystems
services, the Open Soil Index (known by the Dutch acronym OBI from ‘Open
Bodem Index’) was initiated in 2018. The OBI is an open source framework
for assessing and valorizing soil quality and sustainable soil
management. Experts from universities, consultancy companies, soil
science, and farmer groups collaborated to bring together existing data
from routine soil laboratories, smart data retrieval from satellites,
and insights from fundamental and applied research, in a transparent and
scientifically underpinned soil assessment framework. The framework is
highly influenced by the Soil Management Assessment Framework <span class="citation">(Andrews and Carroll 2001; Wienhold, Andrews, and
Karlen 2004; Wienhold et al. 2009)</span> and the proposed holistic,
multivariate soil health framework from <span class="citation">Rinot et
al. (2019)</span>.</p>
</div>
<div class="section level4">
<h4 id="the-open-soil-index-framework">The Open Soil Index Framework<a class="anchor" aria-label="anchor" href="#the-open-soil-index-framework"></a>
</h4>
<p>Soil quality is defined as the capacity of a soil to fulfill the
desired soil functions under varying conditions for a combination of
purposes (and services) such as food production, efficient nutrient
cycling, and preservation of biodiversity. Soil ecosystem services are
the different ecosystem services that soils can provide, being
categorized as production, support, regulation, and information
services. Soil functions are quantitative relationships evaluating how
soil properties alone or in combination with each other contribute to
the aforementioned ecosystem services. Soil indicators are the result of
an evaluation scoring methodology transforming the output of soil
functions to a qualitative category (low to high) or a numeric grade
(1-10). Soil and field properties are characteristics of a soil (or
field) that are used to quantify the soil functions. These
characteristics may have been analyzed in the laboratory as well as
those resulting from the location of the field in the landscape. For
example, the groundwater level, the variation in ground level, the
slope, and the presence of drainage are soil properties. Soil management
includes all measures that land users or farmers can take to improve or
adapt soil quality for a specific purpose. This has a direct influence
on (measurable) soil properties.</p>
<p>Within the boundary condition of context (i.e. continuation of crop
rotation scheme in next decade) and objective (i.e. sustainable crop
production), soil properties are quantified based on routinely available
soil analyses, field properties, and remote sensing data. The soil
properties are in conjunction with each other used to quantify a number
of soil functions. These functions can be clustered around the three
relevant aspects of soil, namely i) chemistry and nutrient supply, ii)
structure and rootability and iii) biology and disease resistance.
Separately from these three aspects - each of which relies heavily on
actual measurements - soil management is also evaluated. Furthermore,
the soil’s contribution to a sustainable living environment is first and
foremost indirectly included as the following soil functions: the N
buffering capacity to avoid leaching and runoff, and the potential to
sequester carbon. The algorithms to evaluate and assess the quality of
the soil originates from field experiments and evidence from fundamental
as well as applied research.</p>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="the-open-soil-index-calculator-obic">2. The Open Soil Index Calculator (OBIC)<a class="anchor" aria-label="anchor" href="#the-open-soil-index-calculator-obic"></a>
</h3>
<p>The OBIC package makes it possible to evaluate Soil Health for a
number of aggregated soil functions, evaluating a series of soil
functions in relation to a “distance to target”.</p>
<div class="section level4">
<h4 id="data-binnenveld">Data: Binnenveld<a class="anchor" aria-label="anchor" href="#data-binnenveld"></a>
</h4>
<p>To explore the functionality of OBIC, we’ll use the dataset
<code>binnenveld</code>. The dataset contains soil properties from 11
agricultural fields in the neighborhood of Wageningen, with different
soil texture and land use, and is documented in
<code><a href="../reference/binnenveld.html">?binnenveld</a></code></p>
<p>For each field, the following properties are available:</p>
<ul>
<li>field properties: ID, landuse (B_LU_BRP) and agricultural region
(B_AER_CBS)</li>
<li>basic soil properties: soil type (B_SOILTYPE_AGR, B_HELP_WENR), risk
for soil compaction (B_SC_WENR) and groundwater level (B_GWL_CLASS)</li>
<li>chemical, physical and biological soil properties obtained from
measurements (all variables starting with “A_”)</li>
<li>measurements done via a Visual Soil Assessment Form (optional, all
variables starting with “A_” and ending with “BCS”). For details, see
the Assessment Form of the <a href="https://mijnbodemconditie.nl/aan-de-slag/download/" class="external-link">Bodemconditiescore</a>
<span class="citation">(Sonneveld, Heuvelink, and Moolenaar
2014)</span>.</li>
<li>soil management measures taken (optional, all variables starting
with “M_”)</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">binnenveld</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3251   55</span></span>
<span>  <span class="va">binnenveld</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt;    A_CLAY_MI  A_N_PMN   A_N_RT A_SOM_LOI   A_P_CC  A_P_AL   A_P_WA  A_PH_CC</span></span>
<span><span class="co">#&gt; 1:  27.33814 96.78448 3447.026  7.065548 1.452009 36.9823 28.34038 6.314309</span></span>
<span><span class="co">#&gt;    A_CEC_CO A_K_CC A_SAND_MI A_SILT_MI A_S_RT A_MG_CC B_SOILTYPE_AGR A_CU_CC</span></span>
<span><span class="co">#&gt; 1:   172.96     82      19.2     40.23 751.14  346.89     rivierklei   16.19</span></span>
<span><span class="co">#&gt;    A_MN_CC A_ZN_CC A_CN_FR A_CA_CO_PO A_MG_CO_PO A_K_CO_PO      B_AER_CBS</span></span>
<span><span class="co">#&gt; 1:     810  561.33       9     114.61     28.099      2.66 Rivierengebied</span></span>
<span><span class="co">#&gt;    B_HELP_WENR B_GWL_CLASS B_SC_WENR B_LU_BRP ID B_GWL_GLG B_GWL_GHG</span></span>
<span><span class="co">#&gt; 1:       Rd10A          VI       901      265  1   1.41177  0.557041</span></span>
<span><span class="co">#&gt;    B_GWL_ZCRIT M_GREEN M_NONBARE M_EARLYCROP M_SLEEPHOSE M_DRAIN M_DITCH</span></span>
<span><span class="co">#&gt; 1:    37.39224   FALSE     FALSE       FALSE       FALSE   FALSE   FALSE</span></span>
<span><span class="co">#&gt;    M_UNDERSEED M_LIME M_NONINVTILL M_SSPM M_SOLIDMANURE M_STRAWRESIDUE</span></span>
<span><span class="co">#&gt; 1:       FALSE  FALSE        FALSE  FALSE         FALSE          FALSE</span></span>
<span><span class="co">#&gt;    M_MECHWEEDS M_PESTICIDES_DST M_COMPOST A_EW_BCS A_SC_BCS A_GS_BCS A_P_BCS</span></span>
<span><span class="co">#&gt; 1:       FALSE            FALSE         0        0        0        0       0</span></span>
<span><span class="co">#&gt;    A_C_BCS A_RT_BCS A_RD_BCS A_SS_BCS A_CC_BCS</span></span>
<span><span class="co">#&gt; 1:       0        0        0        0        0</span></span></code></pre></div>
<p>In this example all optional input variables are set to the lowest
score (for visuals soil assessment) or to false (for soil management
measures). Since soil quality can only be evaluated given its use, the
crop rotation plan determines also which soil properties and which soil
functions are relevant and how they are evaluated given a desired
threshold value.</p>
<p>Note that <code>binnenveld</code> is a data.table, a modern and fast
variant of a data frame <span class="citation">(Dowle and Srinivasan
2021)</span>. It’s particularly useful for large datasets because it
only prints a selection of the dataset and calculations done on a
data.table are extremely fast. You can learn more about data.tables at
<a href="https://CRAN.R-project.org/package=data.table/vignettes/datatable-intro.html" class="external-link">this
link</a> ; in particular you can convert data frames to data.tables with
as.data.table().</p>
</div>
<div class="section level4">
<h4 id="running-obic-for-a-single-field">Running OBIC for a single field<a class="anchor" aria-label="anchor" href="#running-obic-for-a-single-field"></a>
</h4>
<p>The main function to evaluate the quality of the soil is
<code><a href="../reference/obic_field.html">obic_field()</a></code> as well as <code><a href="../reference/obic_field_dt.html">obic_field_dt()</a></code>. Both
are wrappers around the the following steps (where the latter requires a
data.table as input and the former does not):</p>
<ul>
<li>Data preparation:
<ul>
<li>check format B_SC_WENR and B_GWL_CLASS</li>
<li>add default estimates for soil management measures given soil type
and land use</li>
</ul>
</li>
<li>Estimate derivative soil properties
<ul>
<li>general supporting soil properties</li>
<li>soil chemical functions</li>
<li>soil physical functions</li>
<li>soil biological functions</li>
<li>soil environmental functions</li>
<li>soil management actions</li>
<li>visual soil assessment observations</li>
</ul>
</li>
<li>Estimate soil indicators (evaluating soil functions given a distance
to target)
<ul>
<li>soil chemical functions</li>
<li>soil physical functions</li>
<li>soil biological functions</li>
<li>soil environmental functions</li>
<li>soil management actions</li>
<li>visual soil assessment score</li>
</ul>
</li>
<li>Aggregate soil indicators over the crop rotation plan</li>
<li>Aggregate soil functions into more generic soil quality scores
<ul>
<li>for soil chemical, physical, biological and environmental soil
quality (absolute)</li>
<li>for benchmarking (not yet implemented)</li>
</ul>
</li>
</ul>
<p>The process how measurable soil properties are used to evaluate the
agronomic soil quality is visualized in Figure 1.</p>
<p><br></p>
<div class="figure">
<img src="../articles/OBIC_score_integratie_2.png" alt="Figure 1. Graphic representation of how measured soil properties are aggregated to scores." width="85%" height="85%"><p class="caption">
Figure 1. Graphic representation of how measured soil properties are
aggregated to scores.
</p>
</div>
<p><br></p>
<p>An example of both wrapper functions is illustrated below. The soil
has an OBIC score of 0.78 indicating a relatively good quality to
continue the current crop rotation plan. A value of one means that the
soil quality is optimum for the continuation of the cropping plan
whereas a value of zero means that there are substantial bottlenecks
that need to be solved.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># select the relevant columns without management measures and data from Visual Soil Assessment</span></span>
<span>  <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">binnenveld</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'_BCS$|^M_'</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">binnenveld</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># select the first field, a grassland field </span></span>
<span>  <span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">binnenveld</span><span class="op">[</span><span class="va">ID</span><span class="op">==</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># run the obic_field with default management measures and no visual assessment data</span></span>
<span></span>
<span>  <span class="co"># test the obic field function via obic_field and give only the final score</span></span>
<span>  <span class="fu"><a href="../reference/obic_field.html">obic_field</a></span><span class="op">(</span>B_SOILTYPE_AGR <span class="op">=</span>  <span class="va">dt</span><span class="op">$</span><span class="va">B_SOILTYPE_AGR</span>, B_GWL_CLASS <span class="op">=</span>  <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_CLASS</span>,</span>
<span>             B_SC_WENR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_SC_WENR</span>, B_HELP_WENR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_HELP_WENR</span>, B_AER_CBS <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_AER_CBS</span>,</span>
<span>             B_GWL_GLG <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_GLG</span>, B_GWL_GHG <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_GHG</span>, B_GWL_ZCRIT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_ZCRIT</span>,</span>
<span>             B_DRAIN <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_DRAIN</span>, B_FERT_NORM_FR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_FERT_NORM_FR</span>,</span>
<span>             B_LU_BRP <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_LU_BRP</span>, A_SOM_LOI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_SOM_LOI</span>, A_SAND_MI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_SAND_MI</span>,</span>
<span>             A_SILT_MI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_SILT_MI</span>, A_CLAY_MI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CLAY_MI</span>, A_PH_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_PH_CC</span>,</span>
<span>             A_N_RT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_N_RT</span>, A_CN_FR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CN_FR</span>,</span>
<span>             A_S_RT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_S_RT</span>, A_N_PMN <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_N_PMN</span>,</span>
<span>             A_P_AL <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_AL</span>, A_P_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_CC</span>, A_P_WA <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_WA</span>, A_CEC_CO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CEC_CO</span>,</span>
<span>             A_CA_CO_PO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CA_CO_PO</span>, A_MG_CO_PO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_MG_CO_PO</span>, A_K_CO_PO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_K_CO_PO</span>,</span>
<span>             A_K_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_K_CC</span>, A_MG_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_MG_CC</span>, A_MN_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_MN_CC</span>,</span>
<span>             A_ZN_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_ZN_CC</span>, A_CU_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CU_CC</span>, output <span class="op">=</span> <span class="st">'obic_score'</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ID S_T_OBI_A</span></span>
<span><span class="co">#&gt; 1:  1     0.779</span></span>
<span>  </span>
<span>  <span class="co"># test the obic field function via obic_field_dt and give only the final score</span></span>
<span>  <span class="fu"><a href="../reference/obic_field_dt.html">obic_field_dt</a></span><span class="op">(</span><span class="va">dt</span>,output <span class="op">=</span> <span class="st">'obic_score'</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ID S_T_OBI_A</span></span>
<span><span class="co">#&gt; 1:  1     0.779</span></span></code></pre></div>
<p>When interested in the averaged indicator value or the averaged
aggregated soil indicators, one can adjust the output argument of the
wrapper functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># run obic_field to retrieve indicators</span></span>
<span>  <span class="fu"><a href="../reference/obic_field_dt.html">obic_field_dt</a></span><span class="op">(</span><span class="va">dt</span>, output <span class="op">=</span> <span class="st">'indicators'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># run obic_field to retrieve aggregated scores </span></span>
<span>  <span class="co"># for chemistry, biology, fysics, management and environment</span></span>
<span>  <span class="fu"><a href="../reference/obic_field_dt.html">obic_field_dt</a></span><span class="op">(</span><span class="va">dt</span>, output <span class="op">=</span> <span class="st">'scores'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># the default option is to retrieve all output</span></span>
<span>  <span class="fu"><a href="../reference/obic_field_dt.html">obic_field_dt</a></span><span class="op">(</span><span class="va">dt</span>, output <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="the-soil-functions-in-the-obic">The Soil Functions in the OBIC<a class="anchor" aria-label="anchor" href="#the-soil-functions-in-the-obic"></a>
</h3>
<p>To assess the soil quality of an agricultural field, soil properties
are used to derive so-called soil functions. Theses soil functions
represent distinct processes in soil supporting the sustainable crop
development. In this section the available soil functions are presented
and illustrated.</p>
<div class="section level4">
<h4 id="general-supporting-soil-properties">General supporting soil properties<a class="anchor" aria-label="anchor" href="#general-supporting-soil-properties"></a>
</h4>
<p>Since the quality of a soil is evaluated given its crop rotation
plan, soil type, and geohydrological conditions, a few general
derivative soil properties are estimated. These include the calculation
of bulk density, rooting depth, organic carbon stocks, the age of
grassland, and the fraction that a crop contributes to the crop rotation
plan. These general properties are explained below.</p>
<div class="section level5">
<h5 id="estimate-bulk-density">Estimate bulk density<a class="anchor" aria-label="anchor" href="#estimate-bulk-density"></a>
</h5>
<p>Soil Bulk density is estimated via a pedotransferfunction using
‘calc_bulk_density’ currently used in Dutch fertilizer recommendation
systems. It requires as input the agronomic soil type, the soil organic
matter content, and the clay content of the topsoil analyzed. For
details see <code><a href="../reference/calc_bulk_density.html">?calc_bulk_density</a></code>. Generally, the bulk density
declines with the soil organic matter level in the soil and is higher in
sandy soils compared to clayey soils.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="estimate-other-general-properties">Estimate other general properties<a class="anchor" aria-label="anchor" href="#estimate-other-general-properties"></a>
</h5>
<p>Agricultural soils are frequently analyzed in routine agricultural
laboratories. In the Netherlands the soil layer analyzed, is the top
25cm of an arable soil and the first 10 cm of a grassland soil. To
convert soil nutrient concentrations (mg / kg) to a hectare basis, one
need to know the soil depth analyzed. The OBIC function for this is a
rather simple one, <code>calc_root_depth</code> where the details can be
found via <code><a href="../reference/calc_root_depth.html">?calc_root_depth</a></code>. The only input required is the
crop code.</p>
<p>The Carbon pool in soil (kg / ha) is subsequently calculated from the
soil organic matter content, the bulk density, and the sample depth via
<code>calc_organic_carbon</code>. For details, see
<code><a href="../reference/calc_organic_carbon.html">?calc_organic_carbon</a></code>.</p>
<p>The age of grassland is calculated via the function
<code>calc_grass_age</code> given the series of crop codes available per
field. These crop codes have a temporal order with the most recent ones
on top. For details, see <code><a href="../reference/calc_grass_age.html">?calc_grass_age</a></code>.</p>
<p>Lastly, the relative contribution of a few crops to the full crop
rotation plan over the last ten years can be estimated via the function
<code>calc_rotation_fraction</code>. This function has as input the
field-ID, the series of crop codes and the name of the crop for which
one likes to know the relative fraction within a crop rotation plan. The
following options are possible: starch, potato, sugarbeet, grass, mais,
alfalfa, catchcrop, cereal, clover, nature, rapeseed, other, rustgewas,
and rustgewasdiep.</p>
<p>An example of these functions is illustrated below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate soil bulk density</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_BDS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_bulk_density.html">calc_bulk_density</a></span><span class="op">(</span><span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_SOM_LOI</span>, <span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># estimate soil sampling depth</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_RD</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_root_depth.html">calc_root_depth</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># estimate Carbon pool</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_OC</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_organic_carbon.html">calc_organic_carbon</a></span><span class="op">(</span><span class="va">A_SOM_LOI</span>, <span class="va">D_BDS</span>, <span class="va">D_RD</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate age of grassland</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="va">D_GA</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_grass_age.html">calc_grass_age</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate crop rotation fraction for sugar beet</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_SUGARBEET</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"sugarbeet"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="calculate-series-of-chemical-soil-functions">Calculate series of chemical soil functions<a class="anchor" aria-label="anchor" href="#calculate-series-of-chemical-soil-functions"></a>
</h4>
<p>The open soil index quantifies and evaluates the capacity of the soil
to supply nitrogen, phosphorus, potassium, magnesium, copper, and zinc
as well as the capacity of the soil to buffer cations and the pH. The
different functions are illustrated and explained below.</p>
<div class="section level5">
<h5 id="nitrogen-supplying-capacity">Nitrogen supplying capacity<a class="anchor" aria-label="anchor" href="#nitrogen-supplying-capacity"></a>
</h5>
<p>Nitrogen is the nutrient that plants need most and is often the first
limiting factor for growth. Plants take up nitrogen in mineral form as
nitrate and ammonium. However, nitrogen is largely present in the soil
in organic compounds. The availability of N to plants during the growing
season therefore depends on the extent and rate of mineralization from
the organic matter.</p>
<p>Nitrogen supply on grassland is derived from empirical datasets
relating total N levels in soil to the N supply, depending on sampling
depth, soil texture, and the age of the grassland. For arable fields,
the N supply is derived from a simple first order decomposition model,
calibrated for Dutch circumstances and depending on soil texture,
organic matter, and total N content.</p>
<p>To estimate the N supplying capacity of the soil, one can make use of
the function <code>calc_nlv</code>. For more details, see
<code><a href="../reference/calc_nlv.html">?calc_nlv</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate nitrogen supply (kg N / ha)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_NLV</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_nlv.html">calc_nlv</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_N_RT</span>, <span class="va">A_CN_FR</span>, <span class="va">D_OC</span>, <span class="va">D_BDS</span>, <span class="va">D_GA</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
total N and NLV for a grassland soil. In summary, the N supplying
capacity of a soil increases with the total N present in the soil.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>The total N supply is evaluated via a parabolic scoring function with
an optimum of 100 kg N / ha in arable fields and 140 kg N / ha in
grassland fields. The conversion from N supply to an index representing
the distance to target is further explained in section</p>
<p><br></p>
</div>
<div class="section level5">
<h5 id="phosphorus-availability-index">Phosphorus Availability Index<a class="anchor" aria-label="anchor" href="#phosphorus-availability-index"></a>
</h5>
<p>Phosphate (P) is present in the soil in both inorganic and organic.
Inorganic P present in the soil solution is directly available for plant
uptake. The amount of P in the soil solution is small compared to the
total P supply of the soil. Organic P is only available to the plant
after decomposition by micro-organisms. The undissolved inorganic and
organic P compounds can be divided into labile and stable compounds:</p>
<ul>
<li>The labile P fraction is in equilibrium with the P in solution and
is the main source of P re-supply to the soil solution. Labile inorganic
P compounds include P bound to the surface of iron and aluminium (hydr-)
oxides, and iron (Fe), aluminium (Al) and calcium phosphates. In acid
and neutral soils, P availability is mainly determined by its binding to
Fe and Al (hydr-) oxides. In calcareous soils, P is usually associated
with calcium (Ca).</li>
<li>The stable P compounds are usually poorly soluble and therefore
poorly available to plants. Stable inorganic P compounds include
P-containing soil minerals (e.g. apatite).</li>
</ul>
<p>The phosphorus supply of an agricultural soil can be derived from
methods measuring either a capacity or an intensity of P pools in soil
or a combination of both. The latter approach is followed for grassland
and maize fields, where the optimum P supply is derived from multiple
field experiments across the Netherlands. For arable farming systems,
the phosphorus supply is derived from one measured P pool reflecting the
P status as well as controlling the crop response to P inputs. The
availability is highly controlled by chemical adsorption and desorption
equilibria and affected by the iron and aluminum oxides content of soils
as well as the availability of oxygen. A phosphorus supply around 4.8
(unitless index, for maize and grassland fields) and 45 (mg P2O5 per
liter, for arable fields) is optimal for crop production.</p>
<p>To estimate the P availability of the soil, one can make use of the
function <code>calc_phosphate_availability</code>. The function requires
the following input: the BRP crop code and P concentration P measured
via extraction of ammonium lactate (A_P_AL), water (A_P_WA) or 0.01M
CaCl2 (A_P_CC).</p>
<p>For more details, see <code><a href="../reference/calc_phosphate_availability.html">?calc_phosphate_availability</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate phosphate availability index (unitless)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_PBI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_phosphate_availability.html">calc_phosphate_availability</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">A_P_AL</span>, <span class="va">A_P_CC</span>, <span class="va">A_P_WA</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
P-CaCl2 and D_PBI for a grassland soil. In this case the P capacity is
left constant (so, A_P_AL is not changing) whereas the bio-available P
pool is increasing from 0.5 to 10 mg P / kg.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="potassium-supply">Potassium supply<a class="anchor" aria-label="anchor" href="#potassium-supply"></a>
</h5>
<p>Like N and P, potassium (K) an important element for crop growth.
Potassium is almost exclusively present in the soil in mineral form. The
amount of K in the soil can be divided into 4 fractions: * K^+- ions in
the soil solution; completely and directly available to the plant, but
insufficient to cover the needs of the crop * K-exchangeable; K adsorbed
to the clay and humus particles (adsorption complex; CEC). The exchange
between K in the soil solution and K adsorbed occurs rapidly: within
minutes to 24 hours * K-fixed or bound (in clay soils); the K enclosed
in the clay plates. Exchange between K-fixed and K-soil solution takes
days to months * K-mineral or K rock; becomes available through
weathering. The amount of K that becomes available through weathering
during a growing season is too small to be of agricultural interest.</p>
<p>The K supply is strongly controlled by the distribution of K over the
possible K pools in soil, being controlled by adsorption and desorption
processes, the cation exchange capacity of the soil and competing ions
in soil solution and present at the exchange complex. Building on
agronomic research from the last decade, the K supply is quantified for
grasslands using the plant available K fraction (measured via
CaCl2-extraction, K-CaCl2) as well as the CEC. For maize it is
quantified using K-CaCl2 and for arable fields its quantified from
K-CaCl2 and the CEC while accounting for the clay content, the organic
matter content and the pH of the soil.</p>
<p>To estimate the K supplying capacity of the soil, one can make use of
the function <code>calc_potassium_availability</code>. The function
requires the following input: the BRP crop code, the soil type, the
organic matter content, the clay content, the pH, the cation exchange
capacity (CEC), the occupation of the CEC with potassium (%) and the
directly available concentration of K as determined with a soil
extraction with 0.01M CaCl2.</p>
<p>For more details, see <code><a href="../reference/calc_potassium_availability.html">?calc_potassium_availability</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate potassium availability index (unitless)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_K</span> <span class="op">:=</span>  <span class="fu"><a href="../reference/calc_potassium_availability.html">calc_potassium_availability</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_SOM_LOI</span>, <span class="va">A_CLAY_MI</span>, </span>
<span>                                           <span class="va">A_PH_CC</span>, <span class="va">A_CEC_CO</span>, <span class="va">A_K_CO_PO</span>, <span class="va">A_K_CC</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
K-CaCl2 and D_K for a grassland soil. In this case the occupation of the
CEC with K is left constant (so, A_K_CO_PO is not changing) whereas the
bio-available K pool is increasing from 5 to 500 mg K / kg.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="sulfur-supply">Sulfur supply<a class="anchor" aria-label="anchor" href="#sulfur-supply"></a>
</h5>
<p>Sulfur (S) is needed - along with nitrogen - for the formation of
proteins in the plant. Whether S supply from the soil is sufficient for
optimal production and quality depends on the crop’s S requirements and
the S supply in the soil. The S supply is determined by soil processes
and external sulfur supplies to the soil.</p>
<p>The amount of sulfur in the soil that is available for crop uptake is
determined by the mineral sulfur supply remaining in the soil after
winter (Smin), mineralization of sulfur in the soil during the growing
season (sulfur supply capacity), sulfur deposition, sulfur supply by
irrigation during cultivation, capillary rise of sulfur-containing
groundwater, and by possible losses. Sulfur supply, capillary rise, and
Smin are quantitatively the most important inputs of sulfur. However,
all three can vary considerably. The contribution from sulfur deposition
is only minor throughout the Netherlands. A substantial amount of sulfur
can also be supplied through irrigation with sulfurous spring water.
This supply, however, varies greatly, depending on the amount sprayed
and the sulfur content of the water.</p>
<p>To estimate the S supplying capacity of the soil, one can make use of
the function <code>calc_slv</code>. The function requires the following
input: the BRP crop code, the soil type, the agricultural region within
the Netherlands (used to estimate default S deposition rates), the
organic matter content, the total S content of the soil, and the bulk
density.</p>
<p>For more details, see <code><a href="../reference/calc_slv.html">?calc_slv</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate S supplying capacity</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_SLV</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_slv.html">calc_slv</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">B_AER_CBS</span>,<span class="va">A_SOM_LOI</span>,<span class="va">A_S_RT</span>, <span class="va">D_BDS</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
total S and D_SLV for a grassland soil. In this case all soil properties
driving S supplying capacity are left constant whereas the total S pool
is increasing from 500 to 5000 mg S / kg.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="magnesium-supply">Magnesium supply<a class="anchor" aria-label="anchor" href="#magnesium-supply"></a>
</h5>
<p>Magnesium is an important element for crop growth, livestock health,
and livestock productivity. Deficiencies for magnesium often occur on
sandy soils with low organic matter and low pH. The supply of Mg for
arable fields as well as grassland fields on sandy soils is directly
related to the plant available Mg-content (Mg-CaCl2). For grassland
fields on clay and peat soils the Mg-supply is indirectly quantified
given the required composition of the grass (for intake by cows) and
depends on the CEC, the organic matter and clay content, pH, as well as
the K-availability assessed by K-CaCl2 and K-CEC.</p>
<p>To estimate the Mg supplying capacity of the soil, one can make use
of the function <code>calc_magnesium_availability</code>. The function
requires the following input: the BRP crop code, the soil type, the
organic matter content, the clay content, the pH, the cation exchange
capacity (CEC), the occupation of the CEC with potassium (%) and the
directly available concentration of both Mg and K as determined with a
soil extraction with 0.01M CaCl2.</p>
<p>For more details, see <code><a href="../reference/calc_magnesium_availability.html">?calc_magnesium_availability</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate magnesium availability index (unitless)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_MG</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_magnesium_availability.html">calc_magnesium_availability</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_SOM_LOI</span>, </span>
<span>                                           <span class="va">A_CLAY_MI</span>, <span class="va">A_PH_CC</span>, <span class="va">A_CEC_CO</span>,</span>
<span>                                           <span class="va">A_K_CO_PO</span>, <span class="va">A_MG_CC</span>, <span class="va">A_K_CC</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
Mg-CaCl2 and D_MG for a grassland soil. In this case all soil properties
driving Mg availability in soil are left constant whereas the
bio-available Mg pool is increasing from 5 to 500 mg Mg / kg.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="copper-supply">Copper supply<a class="anchor" aria-label="anchor" href="#copper-supply"></a>
</h5>
<p>Copper (Cu) occurs in soil solution largely in a complexed form,
mainly with dissolved organic matter. Root uptake of Cu probably occurs
as free Cu ions (Cu2+). The availability of complexed Cu for uptake is
lower than that of Cu2+ and depends on the stability of the complex.
Complexation of Cu, however, may increase the mobility of Cu in soils.
Besides complexation of Cu to dissolved or solid organic matter, Cu can
be adsorbed to Fe-, Al-, and Mn-(hydr)oxideclay minerals. Cu desorbed
from the mentioned soil components is available for uptake. The degree
of adsorption increases at higher pH, which decreases the availability.
Other factors that influence Cu availability are nitrogen and phosphate
content. Nitrogen and Cu show positive interactions. Decreasing N use
will lead to lower levels in crops. Phosphate can drive Cu away from the
adsorption sites and this leads to Cu deficiency in the long run.</p>
<p>The supply and availability of Cu depends on the plant available
Cu-pool in soil (Cu-CaCl2) or the reactive Cu pool (Cu-HNO3) for both
arable and grassland soils. The optimum value is derived from historical
field experiments and is established on a level of 5 to 10 mg / kg. The
risk of Cu deficiency can be calculated based on the Cu content in the
soil and relevant soil characteristics that influence its availability.
The following measurements are used to calculate Cu plant availability:
land use, Cu-CaCl2, clay content, the organic matter content, and the
plant extractable levels of K and Mn. The last soil properties are used
for an empirical function to estimate Cu-HNO3 (the basis for fertilizer
recommendations based on long-term field experiments) from Cu-CaCl2
(being currently measured in agricultural laboratories). In OBIC, one
can make use of the function <code>calc_copper_availability</code>. The
function requires the input mentioned above.</p>
<p>For more details, see <code><a href="../reference/calc_copper_availability.html">?calc_copper_availability</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate Cu availability index</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CU</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_copper_availability.html">calc_copper_availability</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">A_SOM_LOI</span>, <span class="va">A_CLAY_MI</span>, <span class="va">A_K_CC</span>, <span class="va">A_MN_CC</span>, <span class="va">A_CU_CC</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
Cu-CaCl2 and D_CU for a grassland soil. In this case all soil properties
driving Cu availability in soil are left constant whereas the
bio-available Cu pool is increasing from 5 to 500 ug Cu / kg.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="zinc-supply">Zinc supply<a class="anchor" aria-label="anchor" href="#zinc-supply"></a>
</h5>
<p>The processes involved in the behavior of zinc (Zn) in soil are the
same as for Cu. Besides Zn2+, Zn occurs in the soil solution in complex
form with dissolved organic matter. Binding of Zn to solid soil
constituents occurs to clay minerals, metal (hydr)oxides, and solid
organic matter. The affinity of Zn for binding to these materials is
lower than that of Cu. Zinc is taken up by plant roots as Zn2+. Because
the concentration of Zn2+ in the soil solution is low and Zn is not very
mobile, it is only transported over short distances. Therefore, a
sufficiently large root system is very important for a good Zn uptake.
The development of the root system is strongly influenced by the
phosphate supply of the crop. In herbaceous crops, the secretion of
phytosiderophores in response to a Fe or Zn deficiency strongly
increases Zn uptake. These organic compounds complex Zn and increase Zn
mobility in the soil, which facilitates Zn transport to the root and
uptake as Zn2+. A high pH, cold and wet conditions and a lot of organic
matter in the soil decrease the availability of Zn.</p>
<p>The supply of zinc depends on the plant availability of Zn such as
determined via CaCl2 extraction method (Zn-CaCl2), while accounting for
soil type, land use and pH. Critical threshold values for Zn has been
derived from optimum Zn contents of the growing crop. In OBIC, one can
make use of the function <code>calc_zinc_availability</code>. The
function requires the following input: land use, soil type, pH, and the
bioavailable Zn-content as measured via n extraction with 0.01M
CaCl2.</p>
<p>For more details, see <code><a href="../reference/calc_zinc_availability.html">?calc_zinc_availability</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate Zn availability index</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,  <span class="va">D_ZN</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_zinc_availability.html">calc_zinc_availability</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_PH_CC</span>, <span class="va">A_ZN_CC</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
Zn-CaCl2 and D_ZN for a grassland soil. In this case all soil properties
driving Zn availability in soil are left constant whereas the
bio-available Zn pool is increasing from 50 to 5000 ug Zn / kg.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="soil-acidity">Soil Acidity<a class="anchor" aria-label="anchor" href="#soil-acidity"></a>
</h5>
<p>The pH is a measure of the acidity of the soil. The pH influences the
soil quality and crop growth, among others through availability of
nutrients and (heavy) metals and activity of soil life. In addition, the
pH also influences various soil functions such as nutrient buffering and
aggregate stability. The optimum soil pH for crop growth differs per
crop. Potatoes prefer a lower pH and cereals, maize, sugar beet, and
field vegetables a higher pH. Organic matter reduces the negative effect
of pH on crop growth. On sandy soils with an organic matter content of
15%, the desired pH can be up to half a unit lower than on low organic
matter content soils. On clay soils the desired pH is higher than on
sandy soils. With a clay percentage above 10, the desired pH is half a
unit higher than with low clay percentages.</p>
<p>The optimum pH is determined in historical field experiments given
crop rotation plan, soil texture, soil organic matter, and initial pH.
The derivation of the optimum pH can be estimated via the OBIC using the
function <code>calc_ph_delta</code>. This function estimates how much
the pH has to increase by liming to be optimum for crop development. The
original empirical relationships are based on pH measurements done in
KCl-extraction. Since the current pH analysis methods all make use of
0.01M CaCl2, this pH value can easily be transformed to pH-KCl given an
empirical relationship between both.</p>
<p>For more details, see <code><a href="../reference/calc_ph_delta.html">?calc_ph_delta</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate distance to required pH</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_PH_DELTA</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_ph_delta.html">calc_ph_delta</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_SOM_LOI</span>, <span class="va">A_CLAY_MI</span>, <span class="va">A_PH_CC</span>, <span class="va">D_CP_STARCH</span>,</span>
<span>                                   <span class="va">D_CP_POTATO</span>, <span class="va">D_CP_SUGARBEET</span>, <span class="va">D_CP_GRASS</span>, <span class="va">D_CP_MAIS</span>, <span class="va">D_CP_OTHER</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an arable
and a grassland field (left figure) as well for the relationship between
the initial and desired pH change for a grassland soil. In this case all
soil properties driving pH in soil are left constant whereas the initial
pH is increasing from 3 to 10.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="soil-cation-buffering">Soil Cation Buffering<a class="anchor" aria-label="anchor" href="#soil-cation-buffering"></a>
</h5>
<p>For good crop growth, sufficient nutrients must be available. Besides
the actual nutrient availability in soil solution, the capacity of a
soil to buffer nutrients is important to identify potential bottlenecks
for crop production. fertilization is needed when the buffering capacity
or speed of replenishment is insufficient. Soils can vary greatly in
their buffer capacity. Cations are adsorbed to negatively charged soil
particles (clay, organic matter, and oxides) and these cations may
become available through exchange. For example, a growing plant extracts
K+ from the soil solution. The adsorption complex will start to resupply
because the amount of K+ in the soil solution has decreased. Once again,
a balance is established between the K+ concentration in the soil
solution and the quantity of K+ adsorbed. In practice, soils with a
higher CEC are usually more fertilized and there is a lower risk of
cation deficiencies during the growing season. In general, the optimum
CEC value is around 100 mmol+/kg. CEC levels below 30-40 mmol+/kg are
characterized by substantial crop limitation whereas values above 100
have no positive impact any more. The scientific underpinning of these
guidelines is still poor. In OBIC the soil fertility is positively
assessed in relation to the CEC and can be evaluated with the OBIC
function <code>calc_cec</code>.</p>
<p>For more details, see <code><a href="../reference/calc_cec.html">?calc_cec</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate importance of CEC supporting crop development</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CEC</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_cec.html">calc_cec</a></span><span class="op">(</span><span class="va">A_CEC_CO</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="calculate-series-of-physical-soil-functions">Calculate series of physical soil functions<a class="anchor" aria-label="anchor" href="#calculate-series-of-physical-soil-functions"></a>
</h4>
<p>The open soil index quantifies and evaluates a series of physical
soil functions related to the supply of water and the rootability of the
top and subsoil. The different soil physical functions are illustrated
and explained below. Soil physical functions include the capacity of
soils to retain and supply water, to resist wind erosion, topsoil
sealing, subsoil compaction, and to deliver bearing capacity for
mechanic activities</p>
<div class="section level5">
<h5 id="water-stress-due-to-drought-or-wetness">Water Stress due to drought or wetness<a class="anchor" aria-label="anchor" href="#water-stress-due-to-drought-or-wetness"></a>
</h5>
<p>The supply of water is of uttermost importance for crop development.
The water supply depends on weather conditions and the capacity of soils
to buffer and supply water during the growing season. Using long-term
field experiments for multiple crops, empirical relationships between
soil texture, ground water levels, and yield depressions due to drought
or too wet conditions have been developed (Van Bakel, 2005; Huinink,
2018). Within OBIC the crop yield response to drought stress or
wetnessstress can be estimated via the function
<code>calc_waterstressindex</code>, requiring as input a soil code
(representing unique combinations of soil type and geohydrological
conditions controlling water availability), crop type, and groundwater
level.</p>
<p>For more details, see <code><a href="../reference/calc_waterstressindex.html">?calc_waterstressindex</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># reformat GWL_CLASS</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">B_GWL_CLASS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/format_gwt.html">format_gwt</a></span><span class="op">(</span><span class="va">B_GWL_CLASS</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># estimate risk on yield reduction to drought stress or wetness stress</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WSI_DS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterstressindex.html">calc_waterstressindex</a></span><span class="op">(</span><span class="va">B_HELP_WENR</span>, <span class="va">B_LU_BRP</span>, <span class="va">B_GWL_CLASS</span>, WSI <span class="op">=</span> <span class="st">'droughtstress'</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WSI_WS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterstressindex.html">calc_waterstressindex</a></span><span class="op">(</span><span class="va">B_HELP_WENR</span>, <span class="va">B_LU_BRP</span>, <span class="va">B_GWL_CLASS</span>, WSI <span class="op">=</span> <span class="st">'wetnessstress'</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of this function is illustrated below for both an sandy
and a clay soil given variation in the groundwater levels. In the left
figure the yield reduction to drought stress (D_WSI_DS, red) and wetness
stress (D_WSI_WS, green) are estimated for five fields with different
soil types and crops. In the right figure the impact of variable
groundwater dynamics are estimated for a single field.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="sealing-soil-surface-and-wind-erodibility">Sealing Soil Surface and Wind Erodibility<a class="anchor" aria-label="anchor" href="#sealing-soil-surface-and-wind-erodibility"></a>
</h5>
<p>Sealing is the process whereby soil aggregates disintegrate under the
influence of rain. The impact of raindrops causes a shifting of soil
particles <span class="citation">(Locher and De Bakker 1990)</span>. In
the process, clay and silt particles clog the pores between the sand
particles or the soil aggregates. This creates a slurry layer that forms
a crust after drying. This hinders the gas exchange and increases the
resistance of germinating seed.</p>
<p>Wind erosion can occur in a dry spring or autumn when the soil is
(partly) bare. Wind erosion causes a decrease in organic matter content,
moisture retention capacity, chemical soil fertility, and biological
activity in a soil. Furthermore, wind erosion can spread diseases and
weeds, expose germinating seeds, and damage young plants by
sandblasting.</p>
<p>The vulnerability of soils to sealing and wind erosion is derived
from those properties controlling the susceptibility for both risks.
These include the clay content as well as the organic matter content,
where the vulnerability for sealing is derived from field expert-based
observations and associated yield depression <span class="citation">(J.
Th. M. Huinink 2018; Heeres and Erp 1999)</span> in particular for some
arable crops. The presence of soil sealing can be estimated via the
function <code>calc_sealing_risk</code> whereas the risk for soil
erosion due to wind is estimated via the function
<code>calc_winderodibility</code>. The wind erodibility can be estimated
from the inputs land use, clay and silt content of the topsoil whereas
the risk for sealing depends on the clay content as well as the organic
matter content of the soil.</p>
<p>Wind erosion is highly controlled by the mineralogical composition
and texture as well as the presence of growing crops. Using laboratory
experiments from wind tunnels, a exponential function has been developed
to estimate the erodibility risk for soils, given the clay and silt
content of a field. Grasslands are not susceptible for these two
risks.</p>
<p>For more details, see <code><a href="../reference/calc_sealing_risk.html">?calc_sealing_risk</a></code> and
<code><a href="../reference/calc_winderodibility.html">?calc_winderodibility</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate the presence / risk for surface sealing and wind erodibility</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_SE</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_sealing_risk.html">calc_sealing_risk</a></span><span class="op">(</span><span class="va">A_SOM_LOI</span>, <span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WE</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_winderodibility.html">calc_winderodibility</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">A_CLAY_MI</span>, <span class="va">A_SILT_MI</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>An example of these functions is illustrated below for an arable soil
with variable clay content for both an cropland (with organic matter
levels of 3.5%) and a grassland soil (with organic matter levels of 5%).
Soil sealing is a potential risk and this risk is evaluated in the
indicator function (explained and illustrated later) given the land use
present. The wind erodibility is declining with the clay content and is
not relevant for grassland due to the permanent crop cover.</p>
<p><br></p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="aggregate-stability-and-crumbleability">Aggregate Stability and Crumbleability<a class="anchor" aria-label="anchor" href="#aggregate-stability-and-crumbleability"></a>
</h4>
<p>Crumbleability is an indication of the ease with which the soil can
be broken up or crumbled and of the moisture range within which this is
possible. The crumbleability of a soil is determined by the binding
between soil aggregates. The lower the degree of crumbling, the more
energy is required and the heavier tractors and equipment are needed for
working the soil. This requires (additional) investments and higher fuel
consumption, while the end result - even after additional tillage - is
poorer.</p>
<p>Similarly to the vulnerability to sealing and wind erodibility, the
crumbleability of a soil (a measure for aggregate stability) as well as
the potential risk for yield depressions (crop specific) can be derived
from the clay content, the organic matter content, and the pH <span class="citation">(J. Th. M. Huinink 2011)</span>. Aggregate stability is
additionally evaluated given the cation occupation of the cation
exchange capacity. Clayey soils with 80% Ca, 8% Mg, and about 3.5% K are
recognized as soils with more stable aggregates due to the influence of
electrostatic bindings of divalent cations. Within OBIC these two soil
functions are calculated using <code>calc_crumbleability</code> and
<code>calc_aggregatestability</code>.</p>
<p>For more details, see <code><a href="../reference/calc_crumbleability.html">?calc_crumbleability</a></code> and
<code><a href="../reference/calc_aggregatestability.html">?calc_aggregatestability</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># assess the crumbleability and aggregate stability</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CR</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_crumbleability.html">calc_crumbleability</a></span><span class="op">(</span><span class="va">A_SOM_LOI</span>, <span class="va">A_CLAY_MI</span>,<span class="va">A_PH_CC</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_AS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_aggregatestability.html">calc_aggregatestability</a></span><span class="op">(</span><span class="va">B_SOILTYPE_AGR</span>,<span class="va">A_SOM_LOI</span>,<span class="va">A_K_CO_PO</span>,<span class="va">A_CA_CO_PO</span>,<span class="va">A_MG_CO_PO</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>To illustrate how both functions are estimated in OBIC, we firstly
show the dependency of the crumbleability to varying clay content using
a constant soil organic matter level of 3.5%. As shown below, the
crumbleability starts at a high value of 10 and gradually declines down
to a value of 6 for soils with a clay content of about 25%. The
aggregate stability depends mainly on the calcium occupation of the CEC.
In the figure below the distance to the optimum CEC occupation is
visualized for a series of soils varying in Ca, Mg and K occupation for
a soil where 100% of the CEC is occupied with a variable contribution of
the three cations. The highest aggregate stability is found when the
distance to the optimum is the lowest, being around a Ca occupation of
about 85% of the CEC.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
<div class="section level5">
<h5 id="subsoil-compaction">Subsoil compaction<a class="anchor" aria-label="anchor" href="#subsoil-compaction"></a>
</h5>
<p>Soil compaction is caused by the use of excessively heavy machinery
or by driving over and/or tilling soil with insufficient bearing
capacity. Compaction can lead to poor rooting of the soil, limiting the
absorption of water and nutrients. On heavy soils, compaction mainly
occurs in the soil surface, while on lighter soils there is a risk of
subsoil compaction, such as plough-soil formation. Compaction decreases
the workability of soils and can reduce the water retention capacity of
the soil and impede water transport to deeper layers. This can lead to
an increased risk of surface run-off of nutrients and soil particles.
Soil compaction in the soil can be eliminated by ploughing. Subsoil
compaction is almost impossible to eliminate.</p>
<p>The risk of subsoil compaction for each field was assessed using soil
texture, land use and a soil compaction model SOCOMO. The model
determines whether the usual wheel loads for that land use exceed the
strength of the subsurface in wet or humid conditions. Subsequently it
was determined on the basis of the soil properties and groundwater
levels whether the subsurface is extra sensitive to compaction or
whether natural recovery is possible due to, for example, drought
shrinkage. Strength, land use, and soil properties together determine
the risk of subsoil compaction. The presence of subsoil compaction is
derived from a national map with the estimated risk. As such, there is
no calculation used. Recent field experimental data support the accuracy
of this risk assessment map.</p>
</div>
</div>
<div class="section level4">
<h4 id="visual-soil-assessment">Visual Soil Assessment<a class="anchor" aria-label="anchor" href="#visual-soil-assessment"></a>
</h4>
<p>Within the OBIC, the estimates of aggregate stability and risk of
subsoil compaction can be adapted to local site specific insights
derived from the Visual Soil Assessment Methodology <span class="citation">(Sonneveld, Heuvelink, and Moolenaar 2014)</span>.
Visual soil assessments (VSA) is an assessment of soil quality in the
field, by digging a hole and assessing several soil quality indicators
visually. Soil quality indicators are: grass cover, number of roots,
number of biopores, soil color, soil structure, soil compaction, and
number of gray spots. Visual soil assessments are more and more used by
farmers in the Netherlands, but not specifically developed for various
soil types.</p>
<p>Below is illustrated how the obic_field wrapper deals with the
parameters derived from the VSA methodology. The score derived from the
original risk assessment map for subsoil compaction is overwritten with
the relevant VSA indicators when When scores are present for the
presence of earthworms (A_EW_BCS), the occurrence of subsurface
compaction (A_SC_BCS), limited root development (A_RD_BCS), ponding in
the spring (wet conditions after rainfall, A_P_BCS) and clear presence
of visible tracks / rutting or trampling on the land (A_RT_BCS).
Similarly, the soil aggregate stability is adapted when VSA indicators
are available for earthworm density (A_EW_BCS), soil structure
(A_SS_BCS), and presence of cracks in the topsoil (A_C_BCS).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># overwrite soil physical functions for compaction when BCS is available</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CO</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">A_EW_BCS</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">A_SC_BCS</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">A_RD_BCS</span>  <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">A_P_BCS</span> <span class="op">-</span> <span class="va">A_RT_BCS</span><span class="op">)</span><span class="op">/</span><span class="fl">18</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CO</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">D_P_CO</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">I_P_CO</span> <span class="op">:=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">D_P_CO</span><span class="op">)</span>,<span class="va">I_P_CO</span>,<span class="va">D_P_CO</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># overwrite soil physical functions for aggregate stability when BCS is available</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CEC</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">A_EW_BCS</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">A_SS_BCS</span> <span class="op">-</span> <span class="va">A_C_BCS</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CEC</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">D_P_CEC</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">I_P_CEC</span> <span class="op">:=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">D_P_CEC</span><span class="op">)</span>,<span class="va">I_P_CEC</span>,<span class="va">D_P_CEC</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>In the left figure below one can see how the soil compaction risk is
adapted when information is known from the Visual Soil Assessment. The
soil was originally evaluated as a soil with low compaction, resulting
in a high soil compaction score (the distance to target is small). When
all observations of the VSA have a high quality score (the value 2) then
the score remains the same. As soon as the observations of the VSA show
bottlenecks in the soil structure or rootability (the field score
becomes zero) then the soil compaction score is declined to almost zero
(the distance to target is huge). Similarly, the aggregate stability
score can be adapted, as shown here for a soil with a moderate aggregate
stability index. When field observations support a conclusion for the
soil that the aggregate stability is good (score = 2) then the aggregate
stability index is corrected to the maximum index a soil can retrieve
(the value 1). In contrast, when field observations support the
conclusion of serious bottlenecks for aggregate stability, then the
index declines to almost zero.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
<div class="section level5">
<h5 id="water-retention-in-topsoil">Water retention in topsoil<a class="anchor" aria-label="anchor" href="#water-retention-in-topsoil"></a>
</h5>
<p>The moisture characteristic of a soil depends on its physical
properties, texture, and structure. The texture of a soil is determined
by its clay, loam, and sand content. In addition, almost all soils
contain organic matter. The fine soil particles, together with the
organic matter, contribute to aggregate formation (and thus to the soil
structure). The size, shape, and arrangement of the soil particles and
aggregates, and pores, determine the soil’s capacity to retain water.
Large pores are able to conduct more water faster than small pores,
moreover, removing water from large pores will require less energy than
removing water from small pores. When a soil is at field capacity, the
moisture state is such that all the water in the macro pores has been
replaced by air under the influence of the gravitational potential. The
water that is still present in the soil is retained in micro pores. The
prevailing potential at field capacity can vary from soil to soil but
usually varies between -0.1 bar (sandy soil) to -0.3 bar (loamy soil).
When water is retained to such an extent that it is no longer available
for crop uptake, this is known as the wilting point. The water is mainly
present as a film around individual soil particles. The potential under
these conditions is around -18 bar. The amount of moisture present
between field capacity and wilting point is defined as the amount of
plant-available water.</p>
<p>The review study of various soil health instruments <span class="citation">(E. K. Bünemann et al. 2016)</span> identifies a
variety of indicators that can be used to gain more insight into the
water retaining capacity of a soil. Frequently used indicators are the
amount of plant-available water (14 x), the water holding capacity (11
x), the moisture content at field capacity (11 x), and the saturated
permeability (10 x). These indicators can be measured or estimated
indirectly via so-called pedotransfer functions <span class="citation">(Wösten et al. 2001)</span>.</p>
<p>The OBIC includes functions to derive the following water-related
indicators in function <code>calc_waterretention</code>:</p>
<ul>
<li>the moisture content at wilting point and field capacity</li>
<li>The amount of plant available water (mm)</li>
<li>the flow limit or porosity, also called water holding capacity,
and</li>
<li>the saturated permeability.</li>
</ul>
<p>The basic indicator used in the OBIC is the amount of plant available
water. The capacity of the soil to buffer water during the growing
season is estimated from pedotransferfunctions (pdf) for plant available
water in the topsoil. The default pdf is derived from a European
database, and enables one to estimate the van Genuchten parameters for
the pF-curve. Other options are also possible.</p>
<p>For more details, see <code><a href="../reference/calc_waterretention.html">?calc_waterretention</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate the plant available water in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterretention.html">calc_waterretention</a></span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'plant available water'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the water holding capacity in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterretention.html">calc_waterretention</a></span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'water holding capacity'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the moisture content of the wilting point in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterretention.html">calc_waterretention</a></span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'wilting point'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the moisture content of the field capacity in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterretention.html">calc_waterretention</a></span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'field capacity'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the saturated permeability in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_waterretention.html">calc_waterretention</a></span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'Ksat'</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Below we illustrate how the amount of plant available water (in mm)
changes with clay content, sand content, silt content and soil organic
matter content. All other soil properties are assumed to be
constant.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-34-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="calculate-series-of-biological-soil-functions">Calculate series of biological soil functions<a class="anchor" aria-label="anchor" href="#calculate-series-of-biological-soil-functions"></a>
</h4>
<p>The open soil index quantifies and evaluates a series of soil
biological functions related to the composition of the microbiome,
suppression of soil borne pests and plagues, and plant parasitic
nematodes.</p>
<div class="section level5">
<h5 id="potentially-mineralizable-nitrogen">Potentially mineralizable nitrogen<a class="anchor" aria-label="anchor" href="#potentially-mineralizable-nitrogen"></a>
</h5>
<p>The activity of soil fungi and bacteria has been measured via
incubation trials for decades. In such incubation trials, the
decomposition of soil organic nitrogen is measured over a period of
time. The amount of nitrogen that mineralizes in such trials is called
the ‘potential mineralizable nitrogen’(PMN). This indicates the ability
of the soil to provide a crop with readily available nitrogen. In the
Netherlands, this parameter is also used as an indicator for activity of
soil microbes. This is possible because during the incubation, a soil
sample is submerged in water, creating an anaerobic environment, killing
aerobic bacteria and fungi, which, together with some labile organic
matter, are decomposed by anaerobic soil microbes.</p>
<p>For more information see <code><a href="../reference/calc_pmn.html">?calc_pmn</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># calculate the index for the potential mineralizable nitrogen pool</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_PMN</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_pmn.html">calc_pmn</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_N_PMN</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The PMN measured by routine laboratories in the Netherlands may be
overestimated. Therefore, a land-use dependent correction factor is
used. The PMN index is capped at 500. Below an example of this function
is given.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-36-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="disease-resistance">Disease resistance<a class="anchor" aria-label="anchor" href="#disease-resistance"></a>
</h5>
<p>The activity of the soil life is an indication of the general disease
resistance of the soil. When a soil food web is in balance, the soil’s
resistance to disease and pests is also optimal. The soil’s resistance
to diseases and pests is often cited as a characteristic of a soil with
good biological soil quality. The idea behind this is that a soil with a
well-developed soil food web will be in balance, which means that strong
multiplication of parasitic soil organisms is inhibited by other soil
life. Mechanisms include competition for food or infection sites on the
root, eating the pathogens before they have had a chance to multiply
(myco-parasitism), or secreting (specific) substances that pathogens
cannot tolerate (antibiosis or soil fungistasis).</p>
<p>Organic matter serves as a food source for soil life and influences
the living environment of soil life through its effects on soil
structure and water holding capacity. The quantity and quality of
organic matter can therefore be used as an indicator for the quantity
and activity of soil life, and thus as an indicator for general soil
resilience.</p>
<p>At low organic matter concentrations, the contribution of organic
matter to soil life is negligible. A soil organic matter concentration
between 4% and 10% likely creates the best environment for good disease
resistance.</p>
<p>For more information see <code><a href="../reference/ind_resistance.html">?ind_resistance</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Calculate disease resistance</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_B_DI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_resistance.html">ind_resistance</a></span><span class="op">(</span><span class="va">A_SOM_LOI</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-38-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="earthworm-density">Earthworm density<a class="anchor" aria-label="anchor" href="#earthworm-density"></a>
</h5>
<p>Earthworms are some of the largest fauna found in agricultural soils
and through their tunneling affect nutrient cycling and soil structure.
Analysis and interpretation of earthworm diversity is not regularly done
on Dutch agricultural soils. Earth worm density, the number of
individual worms in a volume of soil, is one of the things studied in
the Visual Soil Assessment (see Visual Soil Assessment for more
information).</p>
</div>
</div>
<div class="section level4">
<h4 id="calculate-series-of-environmental-soil-functions">Calculate series of environmental soil functions<a class="anchor" aria-label="anchor" href="#calculate-series-of-environmental-soil-functions"></a>
</h4>
<p>The open soil index quantifies and evaluates a series of
environmental soil functions related to buffering. Soil environmental
functions include nitrogen leaching and nitrogen runoff.</p>
<div class="section level5">
<h5 id="n-retention-preventing-n-leaching">N retention preventing N leaching<a class="anchor" aria-label="anchor" href="#n-retention-preventing-n-leaching"></a>
</h5>
<p>The capacity of the soil to hold or move nitrogen in the form of
nitrate so that leaching of nitrate to groundwater is prevented is
determined by the landuse, soiltype, groundwater table, N application,
and nitrogen supply capacity. Nitrate is either taken up by a crop,
denitrified (under anaerobic conditions), leached or washed away
(runoff). The potential for N leaching to groundwater for a soil can be
calculated with <code><a href="../reference/calc_nleach.html">calc_nleach()</a></code>.</p>
<p>For more details, see <code><a href="../reference/calc_nleach.html">?calc_nleach</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># calculate potential for N leaching to groundwater</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="va">D_NGW</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_nleach.html">calc_nleach</a></span><span class="op">(</span><span class="va">B_SOILTYPE_AGR</span>, <span class="va">B_LU_BRP</span>, <span class="va">B_GWL_CLASS</span>, <span class="va">D_NLV</span>, <span class="va">B_AER_CBS</span>, leaching_to <span class="op">=</span> <span class="st">"gw"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Examples of this function are given for five parcels with different
attributes, as well as for one field with different groundwater levels,
being derived from so-called groundwatertable. Below is visualized how
for a single field the potential for N leaching and N runoff will change
with the groundwater depth (derived from the groundwater table,
B_GWL_CLASS). Be aware, since these derivative scores on the y-axis are
not yet scaled as distance to target, both scores for leaching and
runoff cannot be compared directly.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-41-1.png" width="672"></p>
<p><br></p>
<p>The properties of the five fields used to illustrate the functions
for N leaching and runoff are summarized in the table below.</p>
<table class="table">
<caption>Examples of Field properties to calculate N leaching and
runoff</caption>
<thead><tr class="header">
<th align="right">field</th>
<th align="left">soiltype</th>
<th align="right">crop</th>
<th align="left">groundwaterclass</th>
<th align="right">nlv</th>
<th align="left">regio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">rivierklei</td>
<td align="right">265</td>
<td align="left">GtIII</td>
<td align="right">141</td>
<td align="left">Rivierengebied</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">rivierklei</td>
<td align="right">265</td>
<td align="left">GtIV</td>
<td align="right">141</td>
<td align="left">Rivierengebied</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">rivierklei</td>
<td align="right">265</td>
<td align="left">GtV</td>
<td align="right">150</td>
<td align="left">Rivierengebied</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">rivierklei</td>
<td align="right">265</td>
<td align="left">GtVI</td>
<td align="right">150</td>
<td align="left">Rivierengebied</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">rivierklei</td>
<td align="right">265</td>
<td align="left">GtVII</td>
<td align="right">150</td>
<td align="left">Rivierengebied</td>
</tr>
</tbody>
</table>
<p>How is the the capacity of soils to retain nitrogen in the topsoil
related to the potential N leaching? Below the relation is illustrated
for the indicator value for one soil showing that the distance to target
(a lower value) increases (whereas the indicator value declines) with
the potential N leaching up to 20 mg N per liter.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-43-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="n-retention-preventing-n-runoff">N retention preventing N runoff<a class="anchor" aria-label="anchor" href="#n-retention-preventing-n-runoff"></a>
</h5>
<p>N-retention to prevent runoff is the ability of a soil to avoid
superficial runoff of nitrate to surface water. Calculating runoff with
the OBIC package works the same as calculating N leaching described
above. Just set leaching_to to ‘ow’ instead of ‘gw’. While the same
input data is required to calculate leaching and runoff, internally the
calculations use different values. Therefore, runoff and leaching may
have different values for a parcel as can be seen in the example below
where runoff is calculated for the same fields as was done for leaching.
Be aware, since these derivative scores on the y-axis are not yet scaled
as distance to target, both scores for leaching and runoff cannot be
compared directly, but the relative differences among fields are
possible to compare.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-44-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="evaluate-soil-management">Evaluate Soil Management<a class="anchor" aria-label="anchor" href="#evaluate-soil-management"></a>
</h4>
<p>Unlike other soil functions, soil management is hard to evaluate
quantitatively. We introduced the expert-judgement driven framework of
the Sustainable Soil Management label (Van der Wal, 2016). This label
was designed in 2016 by a group of soil scientists and consultancy
workers in the Netherlands to implement sustainable soil management
within certification protocols of relevant chain parties in the
agricultural sector. A team of soil experts from research and practice
made a selection of measurable and verifiable soil management measures
that positively contribute to the ecosystem functions of the soil, and
qualitatively assessed their impact on the soil quality while accounting
for two land use categories and three soil type categories. Using this
expert driven management label, the soil management can be
systematically and quantitatively evaluated on field scale. Besides the
current management practices, explicit attention is given to measures
supporting soil organic matter build-up in soils, supporting the key
role of soil organic matter for soil fertility and other ecosystem
services. Because changes in soil organic matter are difficult to
measure, an estimate is made of the net supply or removal of Effective
Organic Matter based on the crop rotation plan and the current manure
practices according the regulations present. This balance is indicative
of the expected developments in the organic matter content of the
soil.</p>
<div class="section level5">
<h5 id="measures">Measures<a class="anchor" aria-label="anchor" href="#measures"></a>
</h5>
<p>The measures taken on a parcel are evaluated according to a grading
system. For arable, maize, and grassland, different measures are
applicable reflecting the sustainability of soil management. For arable,
measures include; 80% of year green cover, &gt;40% rest crop in
rotation, &gt;40% deep rooting dormant crop in rotation, &lt;25% potato
in rotation, use of early cultivars, net positive organic matter
balance. Specifically for maize, measures include: undersowing of grass,
use of catchcrop after harvest (only on clay). For grass, points can be
gained for the grassland age, use of drag hose fertilization, use of
grass/clover mixtures. For grass on peat points can also be received for
using underwaterdrainage and maintenance of ditches.</p>
</div>
<div class="section level5">
<h5 id="crop-rotation-and-som-balance">Crop rotation and SOM balance<a class="anchor" aria-label="anchor" href="#crop-rotation-and-som-balance"></a>
</h5>
<p>A field can receive points for having a positive soil organic matter
balance. A function is included to estimate the organic matter input and
decomposition. For the calculation of the organic matter balance the
parcels’ crops, organic matter concentration and P status are required,
as well as the management aspects compost application frequency and
sowing of catch crops after main crop.</p>
<p>Below, examples are give of how to calculate the organic matter
balance and the management index. The management index requires inputs
that are not obligatory for the wrapper function
<code>obic_field</code>. The function <code>add_management</code> will
check the presence of management parameter values and give defaults
based on soiltype and crop when values are missing. Furthermore,
information on the crop rotation and on the age of grassland are
calculated by <code>calc_rotation_fraction</code> and
<code>calc_grass_age</code> respectively.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># Calculate organic matter balance</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_SOM_BAL</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_sombalance.html">calc_sombalance</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>,<span class="va">A_SOM_LOI</span>, <span class="va">A_P_AL</span>, <span class="va">A_P_WA</span>, <span class="va">M_COMPOST</span>, <span class="va">M_GREEN</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># add management when input is missing</span></span>
<span>    <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'M_GREEN'</span>, <span class="st">'M_NONBARE'</span>, <span class="st">'M_EARLYCROP'</span>,<span class="st">'M_COMPOST'</span>,<span class="st">'M_SLEEPHOSE'</span>,<span class="st">'M_DRAIN'</span>,<span class="st">'M_DITCH'</span>,<span class="st">'M_UNDERSEED'</span>,</span>
<span>              <span class="st">'M_LIME'</span>, <span class="st">'M_NONINVTILL'</span>, <span class="st">'M_SSPM'</span>, <span class="st">'M_SOLIDMANURE'</span>,<span class="st">'M_STRAWRESIDUE'</span>,<span class="st">'M_MECHWEEDS'</span>,<span class="st">'M_PESTICIDES_DST'</span><span class="op">)</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="../reference/add_management.html">add_management</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>,</span>
<span>                                   <span class="va">M_GREEN</span>, <span class="va">M_NONBARE</span>, <span class="va">M_EARLYCROP</span>,<span class="va">M_COMPOST</span>,<span class="va">M_SLEEPHOSE</span>,<span class="va">M_DRAIN</span>,<span class="va">M_DITCH</span>,<span class="va">M_UNDERSEED</span>,</span>
<span>                                   <span class="va">M_LIME</span>, <span class="va">M_NONINVTILL</span>, <span class="va">M_SSPM</span>, <span class="va">M_SOLIDMANURE</span>,<span class="va">M_STRAWRESIDUE</span>,<span class="va">M_MECHWEEDS</span>,<span class="va">M_PESTICIDES_DST</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># calculate grass age</span></span>
<span>     <span class="va">dt</span><span class="op">[</span>, <span class="va">D_GA</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_grass_age.html">calc_grass_age</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span>     </span>
<span>     <span class="co"># Calculate the crop rotation fraction</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_STARCH</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"starch"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_POTATO</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"potato"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_SUGARBEET</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"sugarbeet"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_GRASS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"grass"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_MAIS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"mais"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_OTHER</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"other"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_RUST</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"rustgewas"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_CP_RUSTDEEP</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_rotation_fraction.html">calc_rotation_fraction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">B_LU_BRP</span>, crop <span class="op">=</span> <span class="st">"rustgewasdiep"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Calculate series of management actions</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="va">D_MAN</span> <span class="op">:=</span> <span class="fu"><a href="../reference/calc_management.html">calc_management</a></span><span class="op">(</span><span class="va">A_SOM_LOI</span>,<span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>,<span class="va">B_GWL_CLASS</span>,</span>
<span>                                  <span class="va">D_SOM_BAL</span>,<span class="va">D_CP_GRASS</span>,<span class="va">D_CP_POTATO</span>,<span class="va">D_CP_RUST</span>,<span class="va">D_CP_RUSTDEEP</span>,<span class="va">D_GA</span>,</span>
<span>                                  <span class="va">M_COMPOST</span>,<span class="va">M_GREEN</span>, <span class="va">M_NONBARE</span>, <span class="va">M_EARLYCROP</span>, <span class="va">M_SLEEPHOSE</span>, <span class="va">M_DRAIN</span>,</span>
<span>                                  <span class="va">M_DITCH</span>, <span class="va">M_UNDERSEED</span>, <span class="va">M_LIME</span>, <span class="va">M_NONINVTILL</span>, <span class="va">M_SSPM</span>,</span>
<span>                                  <span class="va">M_SOLIDMANURE</span>,<span class="va">M_STRAWRESIDUE</span>,<span class="va">M_MECHWEEDS</span>,<span class="va">M_PESTICIDES_DST</span></span>
<span>                                  <span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Example of the soil organic matter balance and management on five
fields from the Binnenveld dataset.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-46-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="recommendations">Recommendations<a class="anchor" aria-label="anchor" href="#recommendations"></a>
</h4>
<p>The Open Soil Index (OBI), gives a rating to soil parameters and soil
functions. When a score is sub-optimal (score &lt; 1), it is important
to advise what measures can be taken to improve soil quality. For this
purpose, a list of measures has been developed which had a positive
effect on soil quality in field trials. Within the OBI, soil quality is
assessed at the level of aggregate soil functions: soil chemistry and
nutrient supply, soil physics and rooting, soil biology and disease
resistance, and management). Within each group there are several soil
parameters and functions, which can be specifically improved through
soil management measures. Up to three out of the eleven measures may be
recommended based on the performance of all soil parameters and
functions. The following aspects play a role in compiling the top three
measures that a user is given as inspiration for sustainable soil
management:</p>
<ul>
<li>At what threshold value is an action desirable? A soil is totally
unsuitable for sustainable agricultural production when the OBI score
equals zero, and a soil is perfectly suitable when the OBI score equals
one. A measure only makes sense if a substantial improvement in soil
quality can be expected through these measures.</li>
<li>Are the available measures for improvement collected from the
scientific literature equally important in the case of sub-optimal soil
quality? For example, is the correction of a low pH more important than
the correction of a low phosphate status?</li>
<li>When recommending measures, is it possible to take into account
positive or negative side effects which may occur once the measure is
implemented?</li>
<li>Measures that are advised must be practical and to the point: not
“follow fertilization advice”, but specifically tailored to the element
of which there is a deficiency.</li>
</ul>
<p>The measures included in OBIC are:</p>
<ul>
<li>M1: liming of soil to advisory pH</li>
<li>M2: more compost</li>
<li>M3: apply non-inversion tillage</li>
<li>M4: cultivate tagetes</li>
<li>M5: introduce more deep-rooting crops</li>
<li>M6: use more green manure crops</li>
<li>M7: extend the age of grassland</li>
<li>M8: fertilize in accordance with fertilizer recommendations (broken
down by applicable element)</li>
<li>M9: grow a grass/clover mixture</li>
<li>M10: broaden the botanical composition of grassland</li>
<li>M11: restore subsoil compaction</li>
</ul>
<p>Deciding which measures are presented is controlled by two functions
nested inside <code><a href="../reference/obic_field.html">obic_field()</a></code> (which itself is wrapped by
<code><a href="../reference/obic_field_dt.html">obic_field_dt()</a></code>). For the recommendations to be given, the
output argument of <code><a href="../reference/obic_field.html">obic_field()</a></code> or
<code><a href="../reference/obic_field_dt.html">obic_field_dt()</a></code> should be <em>‘all’</em> or
<em>‘recommendations’</em>. The functions that decide the
recommendations are <code><a href="../reference/obic_evalmeasure.html">obic_evalmeasure()</a></code> and
<code><a href="../reference/obic_recommendations.html">obic_recommendations()</a></code>. The first takes a data table as
input containing the OBI and indicator scores calculated by other
functions in the package. Its output is a data table with measures which
is passed to <code><a href="../reference/obic_recommendations.html">obic_recommendations()</a></code>. This second function
selects the three most appropriate measures to recommend. For more
information on these functions see <code><a href="../reference/obic_evalmeasure.html">?obic_evalmeasure</a></code>,
<code><a href="../reference/obic_recommendations.html">?obic_recommendations</a></code> or <code><a href="../reference/recom.obic.html">?recom.obic</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># evaluate measures</span></span>
<span>    <span class="va">dt.measure</span> <span class="op">&lt;-</span> <span class="fu">OBIC</span><span class="fu">::</span><span class="fu"><a href="../reference/obic_evalmeasure.html">obic_evalmeasure</a></span><span class="op">(</span><span class="va">dt.score</span>, extensive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># make recommendations of top 3 measures</span></span>
<span>    <span class="va">out.recom</span> <span class="op">&lt;-</span> <span class="fu">OBIC</span><span class="fu">::</span><span class="fu"><a href="../reference/obic_recommendations.html">obic_recommendations</a></span><span class="op">(</span><span class="va">dt.measure</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="integrating-soil-functions-into-obic-scores">Integrating Soil Functions into OBIC scores<a class="anchor" aria-label="anchor" href="#integrating-soil-functions-into-obic-scores"></a>
</h4>
<p>The Open Soil Index is a number ranging between 0 to 1, that
holistically represents the soil quality as well as its management. The
score is field specific, accounting for the soil type, geohydrological
site properties and the crop rotation sequence of the last decade. The
final score can be decomposed to aggregated indicators for different
themes (chemical, physical, biological, and management), and these can
be further broken down in to indicators, representing an weighted
evaluation of soil functions over a period of time. The indicator (or
soil function score) for each soil function, ranges between 0 to 1 and
reflects the current situation given its deviation from a target
condition of that specific soil function. With this hierarchical
structure, the OBI offers both integral assessment (i.e. whether a soil
is overall good or not) and specific assessment (i.e. which soil
functions are poorly evaluated and to what extent these soil functions
need to be adapted to improve the overall soil quality to the “optimum
situation”).</p>
<div class="section level5">
<h5 id="evaluating-soil-functions">Evaluating soil functions<a class="anchor" aria-label="anchor" href="#evaluating-soil-functions"></a>
</h5>
<p>Many of the soil function values calculated in the OBIC have a unit
and a target value. D_NLV for example is the nitrogen producing capacity
of the soil and should have a value between -30 and 250. However, values
calculated for individual soil functions have different units making it
complex to integrate into one holistic value. Nor is it easy to assess
whether a given value is good or whether it requires improvement.
Therefore, soil functions are evaluated to and transformed into an index
reflecting the distance to target. These indicators have a value between
0 and 1, 0 being very poor and 1 being excellent (optimal for
agricultural production). This way, the target value is clear and its
easy to see whether an indicator on a field warrants a lot of
improvement or not. Additionally, such scores can easily be turned into
scores ranging from 0-10 which is a commonly used scale for grading, and
therefore easy to interpret.</p>
<p>The OBIC package has functions that transform the value of a soil
function into a score. Examples of such functions are
<code><a href="../reference/ind_nitrogen.html">ind_nitrogen()</a></code>, <code><a href="../reference/ind_sealing.html">ind_sealing()</a></code>,
<code><a href="../reference/ind_pmn.html">ind_pmn()</a></code> and <code><a href="../reference/ind_nretention.html">ind_nretention()</a></code>. Some of these
functions only require the soil function’s value. Others may need soil
type or the cultivated crop as these parameters may require different
evaluation for specific soil types or crops rotation schemes.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Be aware these functions below are not given here to be evaluated.</span></span>
<span>  <span class="co"># They illustrate how the different indices can be evaluated (do not execute them here)</span></span>
<span></span>
<span>  <span class="co"># Calculate indicators for soil chemical functions</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_N</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_nitrogen.html">ind_nitrogen</a></span><span class="op">(</span><span class="va">D_NLV</span>, <span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_P</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_phosphate_availability.html">ind_phosphate_availability</a></span><span class="op">(</span><span class="va">D_PBI</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_K</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_potassium.html">ind_potassium</a></span><span class="op">(</span><span class="va">D_K</span>,<span class="va">B_LU_BRP</span>,<span class="va">B_SOILTYPE_AGR</span>,<span class="va">A_SOM_LOI</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_MG</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_magnesium.html">ind_magnesium</a></span><span class="op">(</span><span class="va">D_MG</span>, <span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_S</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_sulfur.html">ind_sulfur</a></span><span class="op">(</span><span class="va">D_SLV</span>, <span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">B_AER_CBS</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_PH</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_ph.html">ind_ph</a></span><span class="op">(</span><span class="va">D_PH_DELTA</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_CEC</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_cec.html">ind_cec</a></span><span class="op">(</span><span class="va">D_CEC</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_CU</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_copper.html">ind_copper</a></span><span class="op">(</span><span class="va">D_CU</span>,<span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_C_ZN</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_zinc.html">ind_zinc</a></span><span class="op">(</span><span class="va">D_ZN</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>  <span class="co"># Calculate indicators for soil physical functions</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_CR</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_crumbleability.html">ind_crumbleability</a></span><span class="op">(</span><span class="va">D_CR</span>, <span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_SE</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_sealing.html">ind_sealing</a></span><span class="op">(</span><span class="va">D_SE</span>, <span class="va">B_LU_BRP</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_DS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_waterstressindex.html">ind_waterstressindex</a></span><span class="op">(</span><span class="va">D_WSI_DS</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_WS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_waterstressindex.html">ind_waterstressindex</a></span><span class="op">(</span><span class="va">D_WSI_WS</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_DU</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_winderodibility.html">ind_winderodibility</a></span><span class="op">(</span><span class="va">D_WE</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_CO</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_compaction.html">ind_compaction</a></span><span class="op">(</span><span class="va">B_SC_WENR</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_WRI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_waterretention.html">ind_waterretention</a></span><span class="op">(</span><span class="va">D_WRI</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_CEC</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_aggregatestability.html">ind_aggregatestability</a></span><span class="op">(</span><span class="va">D_AS</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_P_WO</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_workability.html">ind_workability</a></span><span class="op">(</span><span class="va">D_WO</span><span class="op">)</span><span class="op">]</span> </span>
<span>  </span>
<span>  <span class="co"># Calculate indicators for soil biological functions</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_B_DI</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_resistance.html">ind_resistance</a></span><span class="op">(</span><span class="va">A_SOM_LOI</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_B_SF</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_pmn.html">ind_pmn</a></span><span class="op">(</span><span class="va">D_PMN</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Calculate indicators for environment</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_E_NGW</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_nretention.html">ind_nretention</a></span><span class="op">(</span><span class="va">D_NGW</span>, leaching_to <span class="op">=</span> <span class="st">"gw"</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">I_E_NSW</span> <span class="op">:=</span> <span class="fu"><a href="../reference/ind_nretention.html">ind_nretention</a></span><span class="op">(</span><span class="va">D_NSW</span>, leaching_to <span class="op">=</span> <span class="st">"ow"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Some of these indicator functions internally use an evaluation
function such as <code><a href="../reference/evaluate_logistic.html">evaluate_logistic()</a></code> and
<code><a href="../reference/evaluate_parabolic.html">evaluate_parabolic()</a></code>. For more information on these
functions or logistic functions in general see
<code>?evaluate_logistic()</code>, <code>?evaluate_parabolic()</code>,
or <a href="https://en.wikipedia.org/wiki/Generalised_logistic_function" class="external-link">link
to Wikipedia</a>. When logistic evaluation is used, there is no linear
relation between the an indicators value and its score. Often the
evaluation is set up so that lower values gain increasingly lower
scores. In other words, poor performance is evaluated more stringent
than good performance. Below, the relation between a soil function
values and their scores (index values) is given. An example of logistic
evaluation can be found in I_P_WS (water stress)</p>
<p><img src="obic_introduction_files/figure-html/plot%20relation%20function%20and%20index%20values-1.png" width="672"></p>
<p>The indicator for management based on the point system of the label
sustainable soil management has a linear relation between the number of
points and the indicator score.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-49-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="crop-and-soil-dependent-applicability-of-functions">Crop and soil dependent applicability of functions<a class="anchor" aria-label="anchor" href="#crop-and-soil-dependent-applicability-of-functions"></a>
</h4>
<p>Not all indicators are relevant for all combinations of soil type and
crop. For example, <code>I_P_DU</code> (wind erodibility) is not
relevant on permanent grassland, as wind erosion is not a problem on
these parcels. The table <code>weight.obic</code> is used to determine
whether an indicator is relevant for a given parcel. Crops are
differentiated into the categories arable, grassland, maize, and nature
according to the crop_category from the table <code>crops.obic</code>.
In soil type a differentiation is made between peat and non peat soils.
If an indicator is not relevant for a given parcel, its score will not
be used in further aggregation.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># load weights.obic (set indicator to zero when not applicable)</span></span>
<span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="fu">OBIC</span><span class="fu">::</span><span class="va"><a href="../reference/weight.obic.html">weight.obic</a></span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Add years per field</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">year</span> <span class="op">:=</span> <span class="va">.I</span>, by <span class="op">=</span> <span class="va">ID</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Select all indicators used for scoring</span></span>
<span>    <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'I_C|I_B|I_P|I_E|I_M|year|crop_cat|SOILT'</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Melt dt and assign main categories for OBI</span></span>
<span>    <span class="va">dt.melt</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                    id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'B_SOILTYPE_AGR'</span>,<span class="st">'crop_category'</span>,<span class="st">'year'</span><span class="op">)</span>, </span>
<span>                    variable.name <span class="op">=</span> <span class="st">'indicator'</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># add categories relevant for aggregating</span></span>
<span>    <span class="co"># C = chemical, P = physics, B = biological, BCS = visual soil assessment</span></span>
<span>    <span class="co"># indicators not used for integrating: IBCS and IM</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span>,<span class="va">cat</span> <span class="op">:=</span> <span class="fu">tstrsplit</span><span class="op">(</span><span class="va">indicator</span>,<span class="st">'_'</span>,keep <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'_BCS$'</span>,<span class="va">indicator</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">indicator</span> <span class="op">!=</span> <span class="st">'I_BCS'</span>, <span class="va">cat</span> <span class="op">:=</span> <span class="st">'IBCS'</span><span class="op">]</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^I_M_'</span>,<span class="va">indicator</span><span class="op">)</span>, <span class="va">cat</span> <span class="op">:=</span> <span class="st">'IM'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Determine number of indicators per category</span></span>
<span>    <span class="va">dt.melt.ncat</span> <span class="op">&lt;-</span> <span class="va">dt.melt</span><span class="op">[</span><span class="va">year</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">cat</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'IBCS'</span>,<span class="st">'IM'</span><span class="op">)</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ncat <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>,by<span class="op">=</span><span class="st">'cat'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># add weighing factor to indicator values</span></span>
<span>    <span class="va">dt.melt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">dt.melt</span>,<span class="va">w</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">crop_category</span>,<span class="va">indicator</span>,<span class="va">weight_nonpeat</span>,<span class="va">weight_peat</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                     by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'crop_category'</span>,<span class="st">'indicator'</span><span class="op">)</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># calculate correction factor for indicator values (low values have more impact than high values, a factor 5)</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span>,<span class="va">cf</span> <span class="op">:=</span> <span class="fu"><a href="../reference/cf_ind_importance.html">cf_ind_importance</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># calculate weighted value for crop category</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span>,<span class="va">value.w</span> <span class="op">:=</span> <span class="va">value</span><span class="op">]</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'veen'</span>,<span class="va">B_SOILTYPE_AGR</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">weight_peat</span> <span class="op">&lt;</span> <span class="fl">0</span>,<span class="va">value.w</span> <span class="op">:=</span> <span class="op">-</span><span class="fl">999</span><span class="op">]</span></span>
<span>    <span class="va">dt.melt</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'veen'</span>,<span class="va">B_SOILTYPE_AGR</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">weight_nonpeat</span> <span class="op">&lt;</span> <span class="fl">0</span>,<span class="va">value.w</span> <span class="op">:=</span> <span class="op">-</span><span class="fl">999</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="aggregated-indicators-per-category">Aggregated indicators per category<a class="anchor" aria-label="anchor" href="#aggregated-indicators-per-category"></a>
</h4>
<p>Each soil indicator belongs to one of five categories (chemical,
physical, biological, environmental or management). A score per category
is calculated by taking the mean score of the underlying functions</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># subset dt.melt for relevant columns only</span></span>
<span>    <span class="va">out.score</span> <span class="op">&lt;-</span>  <span class="va">dt.melt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cat</span>, <span class="va">year</span>, <span class="va">cf</span>, value <span class="op">=</span> <span class="va">value.w</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>    <span class="co"># remove indicator categories that are not used for scoring</span></span>
<span>    <span class="va">out.score</span> <span class="op">&lt;-</span> <span class="va">out.score</span><span class="op">[</span><span class="op">!</span><span class="va">cat</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'IBCS'</span>,<span class="st">'IM'</span>,<span class="st">'BCS'</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># calculate weighted average per indicator category</span></span>
<span>    <span class="va">out.score</span> <span class="op">&lt;-</span> <span class="va">out.score</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cf</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">value</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="va">value</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cat</span>,<span class="va">year</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># for case that a cat has one indicator or one year and has NA</span></span>
<span>    <span class="va">out.score</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="va">value</span> <span class="op">:=</span> <span class="op">-</span><span class="fl">999</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="integrating-over-time">Integrating over time<a class="anchor" aria-label="anchor" href="#integrating-over-time"></a>
</h4>
<p>Till this point, all values and indicators have been calculated for a
range of years (typically ten). Before aggregating values over years, a
correction factor is calculated to give a weight so that recent years
count more than long gone years. After aggregating indicator scores over
years, a single score for each indicator remains. These are the scores
presented to a user when indicators are included in the output of
<code><a href="../reference/obic_field.html">obic_field()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># calculate correction factor per year; recent years are more important</span></span>
<span>    <span class="va">out.score</span><span class="op">[</span>,<span class="va">cf</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">12</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fl">10</span>,<span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>    <span class="co"># calculate weighted average per indicator category per year</span></span>
<span>    <span class="va">out.score</span> <span class="op">&lt;-</span> <span class="va">out.score</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cf</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">value</span><span class="op">)</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="va">value</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">cat</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="holistic-obi-score">Holistic OBI score<a class="anchor" aria-label="anchor" href="#holistic-obi-score"></a>
</h4>
<p>The integration of different soil functions into one score and their
relevance in achieving a specific target (like crop yield) is often
ignored in soil quality assessments (i.e., each function contributes
equally), is based on expert-judgement or derived from multi-variate
statistics analyzing linkages among soil functions and soil and field
properties within large datasets. Large databases are needed in which
all relevant soil properties and functions have been determined as well
as (historical) management. Unfortunately, these databases are scarce so
that expert driven weighing procedures are introduced. Currently, the
total OBIC score is a weighted average of the major soil functions
(aggregated indicators per category) where the weight of each major soil
function is determined by the number of indicators underlying the major
soil function.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># merge out with number per category</span></span>
<span>  <span class="va">out.score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">out.score</span>,<span class="va">dt.melt.ncat</span>, by<span class="op">=</span><span class="st">'cat'</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="co"># calculate weighing factor depending on number of indicators</span></span>
<span>  <span class="va">out.score</span><span class="op">[</span>,<span class="va">cf</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ncat</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># calculated final obi score</span></span>
<span>  <span class="va">out.score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">out.score</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cat</span>,<span class="va">value</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                     <span class="va">out.score</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="st">"T"</span>,value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span> <span class="op">*</span> <span class="va">cf</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The holistic OBI score is given when the argument <em>output</em> in
<code><a href="../reference/obic_field.html">obic_field()</a></code> or <code><a href="../reference/obic_field_dt.html">obic_field_dt()</a></code> is set to
<em>‘all’</em>, <em>‘scores’</em> or <em>‘obic_scores’</em></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># For example</span></span>
<span>  <span class="fu">OBIC</span><span class="fu">::</span><span class="fu"><a href="../reference/obic_field_dt.html">obic_field_dt</a></span><span class="op">(</span><span class="va">binnenveld</span><span class="op">[</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, output <span class="op">=</span> <span class="st">'scores'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">OBIC</span><span class="fu">::</span><span class="fu"><a href="../reference/obic_field_dt.html">obic_field_dt</a></span><span class="op">(</span><span class="va">binnenveld</span><span class="op">[</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, output <span class="op">=</span> <span class="st">'obic_score'</span><span class="op">)</span></span></code></pre></div>
<p>Will give:</p>
<pre><code><span><span class="co">#&gt;    ID S_B_OBI_A S_C_OBI_A S_E_OBI_A S_M_OBI_A S_P_OBI_A S_T_OBI_A</span></span>
<span><span class="co">#&gt; 1:  1     0.998      0.86     0.938     0.586     0.216     0.668</span></span>
<span><span class="co">#&gt;    ID S_T_OBI_A</span></span>
<span><span class="co">#&gt; 1:  1     0.668</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="some-examples-of-outputs">Some examples of outputs<a class="anchor" aria-label="anchor" href="#some-examples-of-outputs"></a>
</h3>
<p>Below OBI scores are presented for the Binnenveld dataset per major
soil function.</p>
<p><img src="obic_introduction_files/figure-html/unnamed-chunk-54-1.png" width="652.8"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Andrews2001" class="csl-entry">
Andrews, Susan S, and C Ronald Carroll. 2001. <span>“<span class="nocase">Designing a soil quality assessment tool for sustainable
agroecosystem management</span>.”</span> <em>Ecological
Applications</em> 11 (6): 1573–85.
</div>
<div id="ref-Bunemann2016" class="csl-entry">
Bünemann, E K, P Mäder, J Wohlfahrt, L Brussaard, G Bongiorno, R De
Goede, V Geissen, L Fleskens, W Sukkel, and Z Bai. 2016. <span>“<span class="nocase">Concepts and indicators of soil quality-a
review</span>.”</span> <em>Interactive Soil Quality Assessment in Europe
and China for Agricultural Productivity and Environmental
Resilience</em>, 1–76.
</div>
<div id="ref-Bunemann2018" class="csl-entry">
Bünemann, Else K, Giulia Bongiorno, Zhanguo Bai, Rachel E Creamer,
Gerlinde De Deyn, Ron de Goede, Luuk Fleskens, Violette Geissen, Thom W
Kuyper, and Paul Mäder. 2018. <span>“<span class="nocase">Soil quality–A
critical review</span>.”</span> <em>Soil Biology and Biochemistry</em>
120: 105–25.
</div>
<div id="ref-R-data.table" class="csl-entry">
Dowle, Matt, and Arun Srinivasan. 2021. <em>Data.table: Extension of
‘Data.frame‘</em>. <a href="https://CRAN.R-project.org/package=data.table" class="external-link">https://CRAN.R-project.org/package=data.table</a>.
</div>
<div id="ref-Heeres1999" class="csl-entry">
Heeres, E, and P J van Erp. 1999. <span>“<span class="nocase">Organic
matter in relation to the susceptability of agricultural soils to
slaking</span>.”</span> <em>Meststoffen (Netherlands)</em>.
</div>
<div id="ref-Huinink2011" class="csl-entry">
Huinink, J. Th. M. 2011. <span>“<span class="nocase">Bodemgeschiktheidsbeoordeling voor Landbouw , Bosbouw en
Recreatie: een optimalisatie van grondwater- en
opppervlaktewaterpeilbeheer</span>.”</span> BodemConsult-Arnhem.
</div>
<div id="ref-Huinink2018" class="csl-entry">
Huinink, J.Th.M. 2018. <span>“<span class="nocase">Bodem/perceel
geschiktheidsbeoordeling voor Landbouw, Bosbouw en Recreatie: t.b.v. een
optimalisatie van grondwater- en oppervlaktewaterpeilbeheer: state of
the art 2018</span>.”</span> BodemConsult-Arnhem. <a href="https://www.bodemconsult.nl" class="external-link">www.bodemconsult.nl</a>.
</div>
<div id="ref-Locher1990" class="csl-entry">
Locher, W P, and H De Bakker. 1990. <em><span class="nocase">Bodemkunde
van Nederland, deel 1: Algemene bodemkunde</span></em>.
</div>
<div id="ref-R-patchwork" class="csl-entry">
Pedersen, Thomas Lin. 2020. <em>Patchwork: The Composer of Plots</em>.
<a href="https://CRAN.R-project.org/package=patchwork" class="external-link">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-R-base" class="csl-entry">
R Core Team. 2021. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-Rinot2019" class="csl-entry">
Rinot, Oshri, Guy J Levy, Yosef Steinberger, Tal Svoray, and Gil Eshel.
2019. <span>“<span class="nocase">Soil health assessment: A critical
review of current methodologies and a proposed new
approach</span>.”</span> <em>Science of the Total Environment</em> 648:
1484–91.
</div>
<div id="ref-Sonneveld2014" class="csl-entry">
Sonneveld, M P W, G B M Heuvelink, and S W Moolenaar. 2014. <span>“<span class="nocase">Application of a visual soil examination and evaluation
technique at site and farm level</span>.”</span> <em>Soil Use and
Management</em> 30 (2): 263–71.
</div>
<div id="ref-R-OBIC" class="csl-entry">
Verweij, Sven, Gerard Ros, Yuki Fujita, and Brent Riechelman. 2022.
<em>OBIC: Calculate the Open Bodem Index (OBI) Score</em>. <a href="https://CRAN.R-project.org/package=OBIC" class="external-link">https://CRAN.R-project.org/package=OBIC</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen,
Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey
Dunnington. 2021. <em>Ggplot2: Create Elegant Data Visualisations Using
the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">https://CRAN.R-project.org/package=ggplot2</a>.
</div>
<div id="ref-Wienhold2004" class="csl-entry">
Wienhold, Brian J, S S Andrews, and D L Karlen. 2004. <span>“<span class="nocase">Soil quality: a review of the science and experiences in
the USA</span>.”</span> <em>Environmental Geochemistry and Health</em>
26 (2): 89–95.
</div>
<div id="ref-Wienhold2009" class="csl-entry">
Wienhold, Brian J, D L Karlen, S S Andrews, and D E Stott. 2009.
<span>“<span class="nocase">Protocol for indicator scoring in the soil
management assessment framework (SMAF)</span>.”</span> <em>Renewable
Agriculture and Food Systems</em>, 260–66.
</div>
<div id="ref-Wosten2001" class="csl-entry">
Wösten, J. H. M., J. G. Veerman, W. J. M. de Groot, and J. Stolte. 2001.
<span>“<span class="nocase">Waterretentie- en doorlatendheids-
karakteristieken van boven en ondergronden in Nederland: de
Staringreeks</span>.”</span> Wageningen: Alterra. <a href="https://edepot.wur.nl/43272" class="external-link">https://edepot.wur.nl/43272</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sven Verweij, Gerard Ros, Yuki Fujita, Brent Riechelman, Kees van den Dool.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
